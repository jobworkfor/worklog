<?xml version="1.0" encoding="UTF-8"?>
<!-- Do not edit this file with editors other than diagrams.net -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="5621px" height="2850px" viewBox="-0.5 -0.5 5621 2850" content="&lt;mxfile host=&quot;app.diagrams.net&quot; modified=&quot;2022-11-01T05:51:24.357Z&quot; agent=&quot;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/106.0.0.0 Safari/537.36&quot; etag=&quot;jWTQdWXezo7VANoxoVdB&quot; version=&quot;20.5.1&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;89uVAJhbzzb_TbjBp1ZZ&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;" style="background-color: rgb(255, 255, 255);"><defs/><g><rect x="1570" y="2170" width="640" height="190" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 637px; height: 1px; padding-top: 2170px; margin-left: 1575px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: &quot;Courier New&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><pre style=""><pre style=""><pre style=""><pre style=""><div style="line-height: 16px;"><div style=""><pre style=""><pre style=""><pre style=""><pre style=""><font face="Consolas, monospace" color="#cccccc"><span style="font-size: 11.0667px;">// aosp_android-12.1.0_r2\frameworks\native\services\surfaceflinger\Scheduler\SchedulerUtils.h</span><span style="font-size: 8.3pt;"><br /></span></font><span style="color: rgb(140, 140, 140); font-family: Consolas, monospace; font-size: 8.3pt; font-style: italic;">// Opaque handle to scheduler connection.<br /></span><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">struct </span><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">ConnectionHandle </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">{<br />    </span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">using </span><span style="color: rgb(55, 31, 128); font-family: Consolas, monospace; font-size: 8.3pt;">Id </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">= </span></font><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">std</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">::</span></font><span style="color: rgb(55, 31, 128); font-family: Consolas, monospace; font-size: 8.3pt;">uintptr_t</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">;<br />    </span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">static constexpr </span><span style="color: rgb(55, 31, 128); font-family: Consolas, monospace; font-size: 8.3pt;">Id </span><span style="color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">INVALID_ID </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">= </span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">static_cast</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">&lt;</span></font><span style="color: rgb(55, 31, 128); font-family: Consolas, monospace; font-size: 8.3pt;">Id</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">&gt;(-</span></font><span style="color: rgb(23, 80, 235); font-family: Consolas, monospace; font-size: 8.3pt;">1</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">);<br /><br />    </span></font><span style="color: rgb(55, 31, 128); font-family: Consolas, monospace; font-size: 8.3pt;">Id </span><span style="color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">id </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">= </span></font><span style="color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">INVALID_ID</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">;<br /><br />    </span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">explicit operator bool</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">() </span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">const </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">{ </span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">return </span><span style="color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">id </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">!= </span></font><span style="color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">INVALID_ID</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">; }<br />};</span></font></pre></pre></pre></pre></div></div></pre></pre></pre></pre></div></div></div></foreignObject><text x="1575" y="2182" fill="rgb(0, 0, 0)" font-family="Courier New" font-size="12px">// aosp_android-12.1.0_r2\frameworks\native\services\surfaceflinger\Scheduler\SchedulerUtils.h// Opaque ha...</text></switch></g><ellipse cx="1715" cy="2224" rx="5" ry="5" fill="#d6b656" stroke="#d6b656" pointer-events="all"/><rect x="1530" y="2370" width="680" height="310" fill="#fff2cc" stroke="#d6b656" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 677px; height: 1px; padding-top: 2370px; margin-left: 1535px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: &quot;Courier New&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><pre style=""><pre style=""><pre style=""><pre style=""><div style="line-height: 16px;"><div style=""><pre style=""><pre style=""><pre style=""><pre style=""><pre style=""><font color="#cccccc"><font face="Consolas, monospace"><span style="font-size: 11.0667px;">// aosp_android-12.1.0_r2\frameworks\base\core\java\android\view\DisplayEventReceiver.java</span></font><font face="Consolas, monospace"><span style="font-size: 8.3pt;"><i style=""><br /></i></span></font></font><span style="font-family: Consolas, monospace; font-size: 8.3pt; color: rgb(0, 0, 128); font-weight: bold;">public abstract class </span><font face="Consolas, monospace"><span style="font-size: 8.3pt;">DisplayEventReceiver {<br /><br />    </span></font><span style="font-family: Consolas, monospace; font-size: 8.3pt; color: rgb(128, 128, 128); font-style: italic;">/**<br /></span><span style="font-family: Consolas, monospace; font-size: 8.3pt; color: rgb(128, 128, 128); font-style: italic;">     * When retrieving vsync events, this specifies that the vsync event should happen at the normal<br /></span><span style="font-family: Consolas, monospace; font-size: 8.3pt; color: rgb(128, 128, 128); font-style: italic;">     * vsync-app tick.<br /></span><span style="font-family: Consolas, monospace; font-size: 8.3pt; color: rgb(128, 128, 128); font-style: italic;">     * </span><span style="font-family: Consolas, monospace; font-size: 8.3pt; color: rgb(128, 128, 128); font-style: italic;">&lt;p&gt;</span><span style="font-family: Consolas, monospace; font-size: 8.3pt; color: rgb(128, 128, 128); font-style: italic;"><br /></span><span style="font-family: Consolas, monospace; font-size: 8.3pt; color: rgb(128, 128, 128); font-style: italic;">     * Needs to be kept in sync with frameworks/native/include/gui/ISurfaceComposer.h<br /></span><span style="font-family: Consolas, monospace; font-size: 8.3pt; color: rgb(128, 128, 128); font-style: italic;">     */<br /></span><span style="font-family: Consolas, monospace; font-size: 8.3pt; color: rgb(128, 128, 128); font-style: italic;">    </span><span style="font-family: Consolas, monospace; font-size: 8.3pt; color: rgb(0, 0, 128); font-weight: bold;">public static final int </span><span style="font-family: Consolas, monospace; font-size: 8.3pt; color: rgb(102, 14, 122); font-weight: bold; font-style: italic;">VSYNC_SOURCE_APP </span><font face="Consolas, monospace"><span style="font-size: 8.3pt;">= </span></font><span style="font-family: Consolas, monospace; font-size: 8.3pt; color: rgb(0, 0, 255);">0</span><font face="Consolas, monospace"><span style="font-size: 8.3pt;">;<br /><br />    </span></font><span style="font-family: Consolas, monospace; font-size: 8.3pt; color: rgb(128, 128, 128); font-style: italic;">/**<br /></span><span style="font-family: Consolas, monospace; font-size: 8.3pt; color: rgb(128, 128, 128); font-style: italic;">     * When retrieving vsync events, this specifies that the vsync event should happen whenever<br /></span><span style="font-family: Consolas, monospace; font-size: 8.3pt; color: rgb(128, 128, 128); font-style: italic;">     * Surface Flinger is processing a frame.<br /></span><span style="font-family: Consolas, monospace; font-size: 8.3pt; color: rgb(128, 128, 128); font-style: italic;">     * </span><span style="font-family: Consolas, monospace; font-size: 8.3pt; color: rgb(128, 128, 128); font-style: italic;">&lt;p&gt;</span><span style="font-family: Consolas, monospace; font-size: 8.3pt; color: rgb(128, 128, 128); font-style: italic;"><br /></span><span style="font-family: Consolas, monospace; font-size: 8.3pt; color: rgb(128, 128, 128); font-style: italic;">     * Needs to be kept in sync with frameworks/native/include/gui/ISurfaceComposer.h<br /></span><span style="font-family: Consolas, monospace; font-size: 8.3pt; color: rgb(128, 128, 128); font-style: italic;">     */<br /></span><span style="font-family: Consolas, monospace; font-size: 8.3pt; color: rgb(128, 128, 128); font-style: italic;">    </span><span style="font-family: Consolas, monospace; font-size: 8.3pt; color: rgb(0, 0, 128); font-weight: bold;">public static final int </span><span style="font-family: Consolas, monospace; font-size: 8.3pt; color: rgb(102, 14, 122); font-weight: bold; font-style: italic;">VSYNC_SOURCE_SURFACE_FLINGER </span><font face="Consolas, monospace"><span style="font-size: 8.3pt;">= </span></font><span style="font-family: Consolas, monospace; font-size: 8.3pt; color: rgb(0, 0, 255);">1</span><font face="Consolas, monospace"><span style="font-size: 8.3pt;">;</span></font></pre></pre></pre></pre></pre></div></div></pre></pre></pre></pre></div></div></div></foreignObject><text x="1535" y="2382" fill="rgb(0, 0, 0)" font-family="Courier New" font-size="12px">// aosp_android-12.1.0_r2\frameworks\base\core\java\android\view\DisplayEventReceiver.javapublic abstract class D...</text></switch></g><ellipse cx="1785" cy="2535" rx="5" ry="5" fill="#d6b656" stroke="#d6b656" pointer-events="all"/><rect x="30" y="0" width="1260" height="20" fill="#ffff00" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1262px; height: 1px; padding-top: 10px; margin-left: 30px;"><div data-drawio-colors="color: #FF0000; " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(255, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">【进程信息】SurfaceFlinger@main：发起进程初始化</div></div></div></foreignObject><text x="30" y="14" fill="#FF0000" font-family="Helvetica" font-size="12px">【进程信息】SurfaceFlinger@main：发起进程初始化</text></switch></g><rect x="30" y="20" width="1260" height="630" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 1257px; height: 1px; padding-top: 20px; margin-left: 35px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: &quot;Courier New&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><pre style=""><pre style=""><pre style=""><pre style=""><div style="line-height: 16px;"><div style=""><font face="Consolas, Courier New, monospace" style=""><font color="#3f7f5f" style="">#18 bionic/libc/bionic/libc_init_dynamic.cpp:155<br /></font>(discriminator 2)  __libc_init<br /><font color="#3f7f5f" style="">#17 frameworks/native/services/surfaceflinger/main_surfaceflinger.cpp:149 <br /></font><b style="">main</b><br /><font color="#3f7f5f" style="">#16 frameworks/native/services/surfaceflinger/SurfaceFlinger.cpp:832  <br /></font>android::SurfaceFlinger::<b style="">init</b>()<br /><font color="#3f7f5f" style="">#15 frameworks/native/services/surfaceflinger/DisplayHardware/HWComposer.cpp:162<br /></font>android::impl::HWComposer::<b style="">setCallback</b>(android::HWC2::ComposerCallback*)<br /><font color="#3f7f5f" style="">#14 frameworks/native/services/surfaceflinger/DisplayHardware/ComposerHal.cpp:189<br /></font>android::Hwc2::impl::Composer::<b style="">registerCallback</b>(</font><font face="Consolas, Courier New, monospace" style="">android::sp&lt;android::hardware::graphics::composer::V2_4::IComposerCallback&gt; const&amp;)<br /><font color="#3f7f5f">#13 frameworks/native/services/surfaceflinger/DisplayHardware/ComposerHal.cpp:191  <br /></font>operator()<br /><font color="#3f7f5f">#12 out/soong/.intermediates/hardware/interfaces/graphics/composer/2.4/<br />android.hardware.graphics.composer@2.4_genc++/gen/android/hardware/graphics/composer/2.4/<br />ComposerClientAll.cpp:1347<br /></font>android::hardware::graphics::composer::V2_4::BpHwComposerClient::<b>registerCallback_2_4</b>(</font><font face="Consolas, Courier New, monospace" style="">android::sp&lt;android::hardware::graphics::composer::V2_4::IComposerCallback&gt; const&amp;)<br /><font color="#3f7f5f">#11 out/soong/.intermediates/hardware/interfaces/graphics/composer/2.4/android.hardware.graphics.composer@2.4_genc++/gen/android/hardware/graphics/composer/2.4/ComposerClientAll.cpp:297<br /></font>android::hardware::graphics::composer::V2_4::BpHwComposerClient::<b>_hidl_registerCallback_2_4</b>(...</font><font face="Consolas, Courier New, monospace" style="">)<br />#10 ??:?  <br />android::hardware::</font><font face="Consolas, Courier New, monospace" style="">BpHwBinder::<b style="">transact</b>(...</font><font face="Consolas, Courier New, monospace" style="">)<br />#09 ??:?  <br />android::hardware::IPCThreadState::<b>transact</b>(...</font><font face="Consolas, Courier New, monospace" style="">)<br /><font color="#3f7f5f">#08 system/libhwbinder/Binder.cpp:135<br /></font>android::hardware::BHwBinder::<b>transact</b>(...</font><font face="Consolas, Courier New, monospace" style="">)<br /><font color="#3f7f5f">#07 out/soong/.intermediates/hardware/interfaces/graphics/composer/2.4/android.hardware.graphics.composer@2.4_genc++/gen/android/hardware/graphics/composer/2.4/ComposerCallbackAll.cpp:653<br /></font>android::hardware::graphics::composer::V2_4::</font><font face="Consolas, Courier New, monospace" style="">BnHwComposerCallback::<b style="">onTransact</b>(...</font><font face="Consolas, Courier New, monospace" style="">)<br /><font color="#3f7f5f">#06 out/soong/.intermediates/hardware/interfaces/graphics/composer/2.1/android.hardware.graphics.composer@2.1_genc++/gen/android/hardware/graphics/composer/2.1/ComposerCallbackAll.cpp:448<br /></font>android::hardware::graphics::composer::V2_1::BnHwComposerCallback::_hidl_onHotplug(...</font><font face="Consolas, Courier New, monospace" style="">)<br /><font color="#3f7f5f">#05 frameworks/native/services/surfaceflinger/DisplayHardware/HWComposer.cpp:89<br /></font>android::(anonymous namespace)::ComposerCallbackBridge::<b>onHotplug</b>(unsigned long, android::hardware::graphics::composer::V2_1::IComposerCallback::Connection)<br /><font color="#3f7f5f">#04 frameworks/native/services/surfaceflinger/SurfaceFlinger.cpp:1797<br /></font>android::</font><font face="Consolas, Courier New, monospace" style="">SurfaceFlinger::<b style="">onComposerHalHotplug</b>(</font><font face="Consolas, Courier New, monospace" style="">unsigned long,</font><font face="Consolas, Courier New, monospace" style="">android::hardware::graphics::composer::V2_1::IComposerCallback::Connection)<br /><font color="#3f7f5f">#03 frameworks/native/services/surfaceflinger/SurfaceFlinger.cpp:2653<br /></font>android::SurfaceFlinger::<b>processDisplayHotplugEventsLocked</b>()<br /><font color="#3f7f5f">#02 frameworks/native/services/surfaceflinger/SurfaceFlinger.cpp:2973<br /></font>android::SurfaceFlinger::<b>processDisplayChangesLocked</b>()   <br /><font color="#3f7f5f">#01 frameworks/native/services/surfaceflinger/SurfaceFlinger.cpp:2833<br /></font>android::</font><font face="Consolas, Courier New, monospace" style="">SurfaceFlinger::<b style="">processDisplayAdded</b>(</font><font face="Consolas, Courier New, monospace" style="">android::wp&lt;android::IBinder&gt; const&amp;,</font><font face="Consolas, Courier New, monospace" style="">android::DisplayDeviceState const&amp;)</font><font face="Consolas, Courier New, monospace" style="background-color: rgb(255, 255, 255);"><br /></font></div></div></pre></pre></pre></pre></div></div></div></foreignObject><text x="35" y="32" fill="rgb(0, 0, 0)" font-family="Courier New" font-size="12px">#18 bionic/libc/bionic/libc_init_dynamic.cpp:155...</text></switch></g><rect x="790" y="1770" width="680" height="970" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 677px; height: 1px; padding-top: 1770px; margin-left: 795px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: &quot;Courier New&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><pre style=""><pre style=""><pre style=""><pre style=""><div style="line-height: 16px;"><div style=""><pre style=""><font color="#cccccc" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">// aosp_android-12.1.0_r2\frameworks\native\services\surfaceflinger\SurfaceFlinger.cpp<br /></font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">void </span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">SurfaceFlinger</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">::</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 98, 122);">initScheduler</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">(</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">const </span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">sp</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">&lt;</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">DisplayDevice</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">&gt;&amp; display) {<br />    </font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">if </span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">(</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">mScheduler</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">) {<br />        </font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(140, 140, 140); font-style: italic;">// If the scheduler is already initialized, this means that we received<br /></span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(140, 140, 140); font-style: italic;">        // a hotplug(connected) on the primary display. In that case we should<br /></span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(140, 140, 140); font-style: italic;">        // update the scheduler with the most recent display information.<br /></span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(140, 140, 140); font-style: italic;">        </span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(31, 84, 46); font-weight: bold;">ALOGW</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">(</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(6, 125, 23);">"Scheduler already initialized, updating instead"</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">);<br />        </font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">mScheduler</span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">-&gt;</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">setRefreshRateConfigs(display</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">-&gt;</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">holdRefreshRateConfigs());<br />        </font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">return</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">;<br />    }<br />    </font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">const auto </span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">currRefreshRate </span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">= display</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">-&gt;</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">getActiveMode()</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">-&gt;</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">getFps();<br />    mRefreshRateStats = std::make_unique&lt;scheduler::RefreshRateStats&gt;(*mTimeStats, currRefreshRate,<br />                                                                      hal::PowerMode::OFF);<br /><br />    </font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">mVsyncConfiguration </span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">= </span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">getFactory().createVsyncConfiguration(</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">currRefreshRate</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">);<br />    </font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">mVsyncModulator </span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">= sp</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">&lt;</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(55, 31, 128);">VsyncModulator</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">&gt;::make(</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">mVsyncConfiguration</span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">-&gt;</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">getCurrentConfigs());<br /><br />    </font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(140, 140, 140); font-style: italic;">// start the EventThread<br /></span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(140, 140, 140); font-style: italic;">    </span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">mScheduler </span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">= </span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">getFactory().createScheduler(display</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">-&gt;</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">holdRefreshRateConfigs(), *</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">this</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">);<br />    </font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">const auto </span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">configs </span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">= </font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">mVsyncConfiguration</span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">-&gt;</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">getCurrentConfigs();<br />    </font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">const </span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(55, 31, 128);">nsecs_t </span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">vsyncPeriod </span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">= </font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">currRefreshRate</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">.getPeriodNsecs();<br />    </font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">mAppConnectionHandle </span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">=<br />            </font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">mScheduler</span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">-&gt;</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt;"><span style="background-color: rgb(204, 204, 204);">createConnection</span><span style="background-color: rgb(255, 255, 255);">(</span></font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(6, 125, 23);">"app"</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">, </font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">mFrameTimeline</span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">-&gt;</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">getTokenManager(),<br />                                         </font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(140, 140, 140); font-style: italic;">/*workDuration=*/</span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">configs</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">.</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">late</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">.</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">appWorkDuration</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">,<br />                                         </font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(140, 140, 140); font-style: italic;">/*readyDuration=*/</span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">configs</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">.</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">late</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">.</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">sfWorkDuration</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">,<br />                                         </font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">impl</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">::</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">EventThread</span><font style="background-color: rgb(255, 255, 255);"><span style="color: rgb(8, 8, 8); font-family: Consolas, monospace; font-size: 8.3pt;">::InterceptVSyncsCallback());<br /></span><span style="font-size: 11.0667px;"><i style=""><font face="consolas" style="" color="#ff3333">    // createConnection 这个函数在 SurfaceFlinger 中调用了两次，一次是创建 "app" 的 Connection，<br />    // 一次是创建 "sf" 的 Connection，可以理解为创建了两套连接，一套给 app 使用，<br />    // 一套给 surfaceFlinger 使用，SF 用 connectionName 以及 id 来标识两套连接，<br />    // * id=0 时，connectionName 的值为 “app”<br />    // * id=1 时，connectionName 的值为 “appsf”<br /></font></i></span><span style="color: rgb(8, 8, 8); font-family: Consolas, monospace; font-size: 8.3pt;">    </span></font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">mSfConnectionHandle </span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">=<br />            </font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">mScheduler</span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">-&gt;</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">createConnection(</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(6, 125, 23);">"appSf"</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">, </font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">mFrameTimeline</span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">-&gt;</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">getTokenManager(),<br />                                         </font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(140, 140, 140); font-style: italic;">/*workDuration=*/</span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">std</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">::</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">chrono</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">::nanoseconds(</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">vsyncPeriod</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">),<br />                                         </font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(140, 140, 140); font-style: italic;">/*readyDuration=*/</span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">configs</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">.</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">late</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">.</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">sfWorkDuration</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">,<br />                                         [</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">this</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">](</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(55, 31, 128);">nsecs_t </span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">timestamp) {<br />                                             </font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">mInterceptor</span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">-&gt;</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">saveVSyncEvent(timestamp);<br />                                         });<br /><br />    </font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">mEventQueue</span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">-&gt;</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">initVsync(</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">mScheduler</span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">-&gt;</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">getVsyncDispatch(), *</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">mFrameTimeline</span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">-&gt;</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">getTokenManager(),<br />                           </font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">configs</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">.</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">late</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">.</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">sfWorkDuration</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">);<br /><br />    </font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">mRegionSamplingThread </span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">=<br /></span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">            </span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">new </span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">RegionSamplingThread(*</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">this</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">, </font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">RegionSamplingThread</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">::EnvironmentTimingTunables());<br />    </font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">mFpsReporter </span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">= </span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">new </span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">FpsReporter(</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">*</span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">mFrameTimeline</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">, *</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">this</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">);<br />    </font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(140, 140, 140); font-style: italic;">// Dispatch a mode change request for the primary display on scheduler<br /></span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(140, 140, 140); font-style: italic;">    // initialization, so that the EventThreads always contain a reference to a<br /></span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(140, 140, 140); font-style: italic;">    // prior configuration.<br /></span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(140, 140, 140); font-style: italic;">    //<br /></span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(140, 140, 140); font-style: italic;">    // This is a bit hacky, but this avoids a back-pointer into the main SF<br /></span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(140, 140, 140); font-style: italic;">    // classes from EventThread, and there should be no run-time binder cost<br /></span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(140, 140, 140); font-style: italic;">    // anyway since there are no connected apps at this point.<br /></span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(140, 140, 140); font-style: italic;">    </span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">mScheduler</span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">-&gt;</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">onPrimaryDisplayModeChanged(</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">mAppConnectionHandle</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">, display</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">-&gt;</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">getActiveMode());<br />    </font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">static auto </span><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">ignorePresentFences </span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">=<br />            base::GetBoolProperty(</font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(6, 125, 23);">"debug.sf.vsync_reactor_ignore_present_fences"</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">s, </font><span style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">false</span><font color="#080808" style="font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 255, 255);">);<br />    mScheduler-&gt;setIgnorePresentFences(<br />            ignorePresentFences ||<br />            getHwComposer().hasCapability(hal::Capability::PRESENT_FENCE_IS_NOT_RELIABLE));<br />}</font></pre></div></div></pre></pre></pre></pre></div></div></div></foreignObject><text x="795" y="1782" fill="rgb(0, 0, 0)" font-family="Courier New" font-size="12px">// aosp_android-12.1.0_r2\frameworks\native\services\surfaceflinger\SurfaceFlinger.cpp...</text></switch></g><rect x="1550" y="1770" width="660" height="250" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 657px; height: 1px; padding-top: 1770px; margin-left: 1555px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: &quot;Courier New&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><pre style=""><pre style=""><pre style=""><pre style=""><div style="line-height: 16px;"><div style=""><pre style=""><pre style=""><font face="Consolas, monospace" color="#cccccc" style="background-color: rgb(255, 255, 255);"><span style="font-size: 11.0667px;">// aosp_android-12.1.0_r2\frameworks\native\services\surfaceflinger\Scheduler\Scheduler.cpp</span><span style="font-size: 8.3pt;"><br /></span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">Scheduler</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(55, 31, 128); font-family: Consolas, monospace; font-size: 8.3pt;">ConnectionHandle </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">Scheduler</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 98, 122); font-family: Consolas, monospace; font-size: 8.3pt;">createConnection</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">(<br />        </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">const char</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">* connectionName, </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">frametimeline</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">TokenManager</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">* tokenManager,<br />        </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">std</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">chrono</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(55, 31, 128); font-family: Consolas, monospace; font-size: 8.3pt;">nanoseconds </span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">workDuration, </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">std</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">chrono</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(55, 31, 128); font-family: Consolas, monospace; font-size: 8.3pt;">nanoseconds </span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">readyDuration,<br />        </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">impl</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">EventThread</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(55, 31, 128); font-family: Consolas, monospace; font-size: 8.3pt;">InterceptVSyncsCallback </span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">interceptCallback) {<br />    </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">auto </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">vsyncSource </span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">= makePrimaryDispSyncSource(connectionName, workDuration, readyDuration);<br />    </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">auto </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">throttleVsync </span><font color="#080808" face="Consolas, monospace" style=""><span style="font-size: 8.3pt;"><span style="background-color: rgb(255, 255, 255);">= </span><span style="background-color: rgb(204, 204, 204);">makeThrottleVsyncCallback</span><span style="background-color: rgb(255, 255, 255);">();<br />    </span></span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">auto </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">getVsyncPeriod </span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">= makeGetVsyncPeriodFunction();<br />    </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">auto </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">eventThread </span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">= </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">std</span><font color="#080808" face="Consolas, monospace" style=""><span style="font-size: 8.3pt;"><span style="background-color: rgb(255, 255, 255);">::</span><span style="background-color: rgb(204, 204, 204);">make_unique&lt;</span></span></font><span style="background-color: rgb(204, 204, 204);"><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">impl</span><font color="#080808" face="Consolas, monospace" style=""><span style="font-size: 8.3pt;">::</span></font><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">EventThread</span></span><font color="#080808" face="Consolas, monospace" style=""><span style="font-size: 8.3pt;"><span style="background-color: rgb(204, 204, 204);">&gt;</span><span style="background-color: rgb(255, 255, 255);">(</span></span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">std</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::move(</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">vsyncSource</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">), tokenManager,<br />                                                           </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">std</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::move(interceptCallback),<br />                                                           </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">std</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::move(</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">throttleVsync</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">),<br />                                                           </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">std</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::move(</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">getVsyncPeriod</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">));<br />    </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">return </span><span style="color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(204, 204, 204);">createConnection</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">(</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">std</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::move(</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">eventThread</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">));<br />}</span></font></pre></pre></div></div></pre></pre></pre></pre></div></div></div></foreignObject><text x="1555" y="1782" fill="rgb(0, 0, 0)" font-family="Courier New" font-size="12px">// aosp_android-12.1.0_r2\frameworks\native\services\surfaceflinger\Scheduler\Scheduler.cppScheduler::Connecti...</text></switch></g><path d="M 1050 2145 Q 1080 2145 1300 1957.5 Q 1520 1770 1543.63 1770" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1548.88 1770 L 1541.88 1773.5 L 1543.63 1770 L 1541.88 1766.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><ellipse cx="1045" cy="2145" rx="5" ry="5" fill="#000000" stroke="none" pointer-events="all"/><rect x="2270" y="1770" width="650" height="630" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 647px; height: 1px; padding-top: 1770px; margin-left: 2275px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: &quot;Courier New&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><pre style=""><pre style=""><pre style=""><pre style=""><div style="line-height: 16px;"><div style=""><pre style=""><pre style=""><pre style="background-color: rgb(255, 255, 255);"><font face="Consolas, monospace" color="#cccccc"><span style="font-size: 11.0667px;">// aosp_android-12.1.0_r2\frameworks\native\services\surfaceflinger\Scheduler\EventThread.cpp</span><span style="font-size: 8.3pt;"><br /></span></font><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">EventThread</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">::</span></font><span style="color: rgb(0, 98, 122); font-family: Consolas, monospace; font-size: 8.3pt;">EventThread</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">(</span></font><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">std</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">::</span></font><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">unique_ptr</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">&lt;</span></font><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">VSyncSource</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">&gt; vsyncSource,<br />                         </span></font><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">android</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">::</span></font><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">frametimeline</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">::</span></font><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">TokenManager</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">* tokenManager,<br />                         </span></font><span style="color: rgb(55, 31, 128); font-family: Consolas, monospace; font-size: 8.3pt;">InterceptVSyncsCallback </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">interceptVSyncsCallback,<br />                         </span></font><span style="color: rgb(55, 31, 128); font-family: Consolas, monospace; font-size: 8.3pt;">ThrottleVsyncCallback </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">throttleVsyncCallback,<br />                         </span></font><span style="color: rgb(55, 31, 128); font-family: Consolas, monospace; font-size: 8.3pt;">GetVsyncPeriodFunction </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">getVsyncPeriodFunction)<br />      : </span></font><span style="color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">mVSyncSource</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">(</span></font><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">std</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">::move(vsyncSource)),<br />        </span></font><span style="color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">mTokenManager</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">(tokenManager),<br />        </span></font><span style="color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">mInterceptVSyncsCallback</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">(</span></font><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">std</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">::move(interceptVSyncsCallback)),<br />        </span></font><span style="color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">mThrottleVsyncCallback</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">(</span></font><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">std</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">::move(throttleVsyncCallback)),<br />        </span></font><span style="color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">mGetVsyncPeriodFunction</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">(</span></font><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">std</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">::move(getVsyncPeriodFunction)),<br />        </span></font><span style="color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">mThreadName</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">(</span></font><span style="color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">mVSyncSource</span><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">-&gt;</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">getName()) {<br /><br />    </span></font><span style="color: rgb(31, 84, 46); font-family: Consolas, monospace; font-size: 8.3pt; font-weight: bold;">LOG_ALWAYS_FATAL_IF</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">(getVsyncPeriodFunction </span></font><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">== </span><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">nullptr</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">,<br />            </span></font><span style="color: rgb(6, 125, 23); font-family: Consolas, monospace; font-size: 8.3pt;">"getVsyncPeriodFunction must not be null"</span><span style="font-family: Consolas, monospace; color: rgb(8, 8, 8); font-size: 8.3pt;">);<br /></span><span style="font-size: 11.0667px;"><font color="#ff3333" style="" face="consolas"><i style="">    // EventThread 对象是 VSyncSource::Callback 的派生类，通过 setCallback() 方法<br />    // 将本对象设置到 mVSyncSource 对象中，监听底层 VSync 事件<br /></i></font></span><span style="font-family: Consolas, monospace; color: rgb(8, 8, 8); font-size: 8.3pt;">    </span><span style="color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">mVSyncSource</span><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">-&gt;</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">setCallback(</span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">this</span><span style="color: rgb(8, 8, 8); font-family: Consolas, monospace; font-size: 8.3pt;">);<br /></span><span style="font-size: 11.0667px;"><font face="consolas" style="" color="#ff3333"><i style="">    // 新建线程，当底层上报 VSync 事件时，通过 wait-notify 机制唤醒该线程并在其中处理上报的 VSync 事件<br /></i></font></span><span style="color: rgb(8, 8, 8); font-family: Consolas, monospace; font-size: 8.3pt;">    </span><span style="color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">mThread </span><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">= std</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">::thread([</span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">this</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">]() </span></font><span style="color: rgb(31, 84, 46); font-family: Consolas, monospace; font-size: 8.3pt; font-weight: bold;">NO_THREAD_SAFETY_ANALYSIS </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">{<br />        </span></font><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">std</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">::</span></font><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">unique_lock</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">&lt;</span></font><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">std</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">::</span></font><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">mutex</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">&gt; </span></font><span style="color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">lock</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">(</span></font><span style="color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">mMutex</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">);<br />        threadMain(</span></font><span style="color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">lock</span><span style="font-family: Consolas, monospace; color: rgb(8, 8, 8); font-size: 8.3pt;">);<br />    });<br /></span><span style="font-size: 11.0667px;"><font color="#ff3333" style="" face="consolas"><i>    // 设置线程名称为 “app”<br /></i></font></span><span style="font-family: Consolas, monospace; color: rgb(8, 8, 8); font-size: 8.3pt;">    pthread_setname_np(</span><span style="color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">mThread</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">.native_handle(), </span></font><span style="color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">mThreadName</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">);<br /><br />    </span></font><span style="color: rgb(55, 31, 128); font-family: Consolas, monospace; font-size: 8.3pt;">pid_t </span><span style="color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">tid </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">= pthread_gettid_np(</span></font><span style="color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">mThread</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">.native_handle());<br /><br />    </span></font><span style="color: rgb(140, 140, 140); font-family: Consolas, monospace; font-size: 8.3pt; font-style: italic;">// Use SCHED_FIFO to minimize jitter<br /></span><span style="color: rgb(140, 140, 140); font-family: Consolas, monospace; font-size: 8.3pt; font-style: italic;">    </span><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">constexpr int </span><span style="color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">EVENT_THREAD_PRIORITY </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">= </span></font><span style="color: rgb(23, 80, 235); font-family: Consolas, monospace; font-size: 8.3pt;">2</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">;<br />    </span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">struct </span><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">sched_param </span><span style="color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">param </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">= {</span></font><span style="color: rgb(23, 80, 235); font-family: Consolas, monospace; font-size: 8.3pt;">0</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">};<br />    </span></font><span style="color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">param</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">.</span></font><span style="color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">sched_priority </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">= </span></font><span style="color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">EVENT_THREAD_PRIORITY</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">;<br />    </span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">if </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">(pthread_setschedparam(</span></font><span style="color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">mThread</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">.native_handle(), </span></font><span style="color: rgb(31, 84, 46); font-family: Consolas, monospace; font-size: 8.3pt; font-weight: bold;">SCHED_FIFO</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">, &amp;</span></font><span style="color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">param</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">) != </span></font><span style="color: rgb(23, 80, 235); font-family: Consolas, monospace; font-size: 8.3pt;">0</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">) {<br />        </span></font><span style="color: rgb(31, 84, 46); font-family: Consolas, monospace; font-size: 8.3pt; font-weight: bold;">ALOGE</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">(</span></font><span style="color: rgb(6, 125, 23); font-family: Consolas, monospace; font-size: 8.3pt;">"Couldn't set SCHED_FIFO for EventThread"</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">);<br />    }<br /><br />    set_sched_policy(</span></font><span style="color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">tid</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">, SP_FOREGROUND);<br />}</span></font></pre></pre></pre></div></div></pre></pre></pre></pre></div></div></div></foreignObject><text x="2275" y="1782" fill="rgb(0, 0, 0)" font-family="Courier New" font-size="12px">// aosp_android-12.1.0_r2\frameworks\native\services\surfaceflinger\Scheduler\EventThread.cppEventThread::Ev...</text></switch></g><path d="M 1940 1915 Q 1970 1915 2105 1842.5 Q 2240 1770 2263.63 1770" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2268.88 1770 L 2261.88 1773.5 L 2263.63 1770 L 2261.88 1766.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><ellipse cx="1935" cy="1915" rx="5" ry="5" fill="#000000" stroke="none" pointer-events="all"/><rect x="2270" y="2430" width="680" height="250" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 677px; height: 1px; padding-top: 2430px; margin-left: 2275px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: &quot;Courier New&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><pre style=""><pre style=""><pre style=""><pre style=""><div style="line-height: 16px;"><div style=""><pre style=""><pre style=""><pre style=""><font face="Consolas, monospace" color="#cccccc" style="background-color: rgb(255, 255, 255);"><span style="font-size: 11.0667px;">// aosp_android-12.1.0_r2\frameworks\native\services\surfaceflinger\Scheduler\Scheduler.cpp</span><span style="font-size: 8.3pt;"><br /></span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">Scheduler</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(55, 31, 128); font-family: Consolas, monospace; font-size: 8.3pt;">ConnectionHandle </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">Scheduler</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 98, 122); font-family: Consolas, monospace; font-size: 8.3pt;">createConnection</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">(</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">std</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">unique_ptr</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">&lt;</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">EventThread</span><span style="background-color: rgb(255, 255, 255); font-family: Consolas, monospace; color: rgb(8, 8, 8); font-size: 8.3pt;">&gt; eventThread) {<br /></span><span style="background-color: rgb(255, 255, 255); font-size: 11.0667px;"><font color="#ff3333" style="" face="consolas"><i style="">    // ConnectionHandle 是一个结构体，仅有一个 id 成员（值从0开始累加）<br />    // ConnectionHandle 结构作为 connection 对象的索引，保存在 Scheduler::mConnections 中<br /></i></font></span><span style="background-color: rgb(255, 255, 255); font-family: Consolas, monospace; color: rgb(8, 8, 8); font-size: 8.3pt;">    </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">const </span><span style="color: rgb(55, 31, 128); font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(255, 242, 204);">ConnectionHandle </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">handle </span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">= ConnectionHandle{</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">mNextConnectionHandleId</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">++};<br />    </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(31, 84, 46); font-family: Consolas, monospace; font-size: 8.3pt; font-weight: bold;">ALOGV</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">(</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(6, 125, 23); font-family: Consolas, monospace; font-size: 8.3pt;">"Creating a connection handle with ID %" </span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">PRIuPTR, </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">handle</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">.</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">id</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">);<br /><br />    </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">auto </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">connection </span><font color="#080808" face="Consolas, monospace" style=""><span style="font-size: 8.3pt;"><span style="background-color: rgb(255, 255, 255);">= </span><span style="background-color: rgb(204, 204, 204);">createConnectionInternal</span><span style="background-color: rgb(255, 255, 255);">(eventThread.get());<br /><br />    </span></span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">std</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">lock_guard</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">&lt;</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">std</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">mutex</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">&gt; </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">lock</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">(</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">mConnectionsLock</span><font style=""><span style="background-color: rgb(255, 255, 255); font-size: 8.3pt;"><font face="Consolas, monospace" style="color: rgb(8, 8, 8);">);<br /></font><i style=""><font face="consolas" style="" color="#ff3333">    // 保存到 </font></i></span><span style="font-size: 11.0667px;"><i style=""><font face="consolas" color="#ff3333" style=""><span style="background-color: rgb(255, 255, 255);">unordered_map 中，根据客户端传入的 </span><span style="background-color: rgb(255, 242, 204);">VSync 类型值</span><span style="background-color: rgb(255, 255, 255);">索引对应的 connection 对象</span></font></i></span><span style="background-color: rgb(255, 255, 255); font-size: 8.3pt;"><i style=""><font face="consolas" style="" color="#ff3333"><br /></font></i><font face="Consolas, monospace" style="color: rgb(8, 8, 8);">    mConnections.emplace(handle, Connection{connection, std::move(eventThread)});<br />    </font></span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">return </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">handle</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">;<br />}</span></font></pre></pre></pre></div></div></pre></pre></pre></pre></div></div></div></foreignObject><text x="2275" y="2442" fill="rgb(0, 0, 0)" font-family="Courier New" font-size="12px">// aosp_android-12.1.0_r2\frameworks\native\services\surfaceflinger\Scheduler\Scheduler.cppScheduler::ConnectionH...</text></switch></g><path d="M 1740 1985 Q 1770 1985 2005 2207.5 Q 2240 2430 2263.63 2430" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2268.88 2430 L 2261.88 2433.5 L 2263.63 2430 L 2261.88 2426.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><ellipse cx="1735" cy="1985" rx="5" ry="5" fill="#000000" stroke="none" pointer-events="all"/><path d="M 1720 2224 Q 1750 2224 2057 2369 Q 2364 2514 2387.63 2514" fill="none" stroke="#d6b656" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2392.88 2514 L 2385.88 2517.5 L 2387.63 2514 L 2385.88 2510.5 Z" fill="#d6b656" stroke="#d6b656" stroke-miterlimit="10" pointer-events="all"/><ellipse cx="2399" cy="2514" rx="5" ry="5" fill="#d6b656" stroke="#d6b656" pointer-events="all"/><path d="M 1790 2535 Q 1820 2535 2200 2570 Q 2580 2605 2603.63 2605" fill="none" stroke="#d6b656" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2608.88 2605 L 2601.88 2608.5 L 2603.63 2605 L 2601.88 2601.5 Z" fill="#d6b656" stroke="#d6b656" stroke-miterlimit="10" pointer-events="all"/><ellipse cx="2615" cy="2605" rx="5" ry="5" fill="#d6b656" stroke="#d6b656" pointer-events="all"/><rect x="2990" y="2430" width="650" height="120" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 647px; height: 1px; padding-top: 2430px; margin-left: 2995px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: &quot;Courier New&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><pre style=""><pre style=""><pre style=""><pre style=""><div style="line-height: 16px;"><div style=""><pre style=""><pre style=""><pre style=""><pre style=""><font face="Consolas, monospace" color="#cccccc" style="background-color: rgb(255, 255, 255);"><span style="font-size: 11.0667px;">// aosp_android-12.1.0_r2\frameworks\native\services\surfaceflinger\Scheduler\Scheduler.cpp</span><span style="font-size: 8.3pt;"><br /></span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">sp</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">&lt;</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">EventThreadConnection</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">&gt; </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">Scheduler</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 98, 122); font-family: Consolas, monospace; font-size: 8.3pt;">createConnectionInternal</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">(<br />        </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">EventThread</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">* eventThread, </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">ISurfaceComposer</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(55, 31, 128); font-family: Consolas, monospace; font-size: 8.3pt;">EventRegistrationFlags </span><span style="background-color: rgb(255, 255, 255); font-family: Consolas, monospace; color: rgb(8, 8, 8); font-size: 8.3pt;">eventRegistration) {<br /></span><span style="background-color: rgb(255, 255, 255); font-size: 11.0667px;"><font style="" face="consolas" color="#ff0000"><i>    // 参数1是一个 lamda 表达式，是一个函数对象，保存在 EventThreadConnection::resyncCallback 变量中<br /></i></font></span><span style="background-color: rgb(255, 255, 255); font-family: Consolas, monospace; color: rgb(8, 8, 8); font-size: 8.3pt;">    </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">return </span><font color="#080808" face="Consolas, monospace" style=""><span style="font-size: 8.3pt;"><span style="background-color: rgb(255, 255, 255);">eventThread-&gt;</span><span style="background-color: rgb(204, 204, 204);">createEventConnection</span><span style="background-color: rgb(255, 255, 255);">([&amp;] { resync(); }, eventRegistration);<br />}</span></span></font></pre></pre></pre></pre></div></div></pre></pre></pre></pre></div></div></div></foreignObject><text x="2995" y="2442" fill="rgb(0, 0, 0)" font-family="Courier New" font-size="12px">// aosp_android-12.1.0_r2\frameworks\native\services\surfaceflinger\Scheduler\Scheduler.cppsp&lt;EventThreadCon...</text></switch></g><path d="M 2570 2565 Q 2600 2565 2780 2497.5 Q 2960 2430 2983.63 2430" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2988.88 2430 L 2981.88 2433.5 L 2983.63 2430 L 2981.88 2426.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><ellipse cx="2565" cy="2565" rx="5" ry="5" fill="#000000" stroke="none" pointer-events="all"/><rect x="3710" y="2430" width="640" height="150" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 637px; height: 1px; padding-top: 2430px; margin-left: 3715px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: &quot;Courier New&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><pre style=""><pre style=""><pre style=""><pre style=""><div style="line-height: 16px;"><div style=""><pre style=""><pre style=""><pre style=""><pre style=""><pre style=""><font face="Consolas, monospace" color="#cccccc" style="background-color: rgb(255, 255, 255);"><span style="font-size: 11.0667px;">// aosp_android-12.1.0_r2\frameworks\native\services\surfaceflinger\Scheduler\EventThread.cpp</span><span style="font-size: 8.3pt;"><br /></span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">sp</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">&lt;</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">EventThreadConnection</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">&gt; </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">EventThread</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 98, 122); font-family: Consolas, monospace; font-size: 8.3pt;">createEventConnection</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">(<br />        </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(55, 31, 128); font-family: Consolas, monospace; font-size: 8.3pt;">ResyncCallback </span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">resyncCallback,<br />        </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">ISurfaceComposer</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(55, 31, 128); font-family: Consolas, monospace; font-size: 8.3pt;">EventRegistrationFlags </span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">eventRegistration) </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">const </span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">{<br />    </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">return new </span><font color="#080808" face="Consolas, monospace" style=""><span style="font-size: 8.3pt;"><span style="background-color: rgb(204, 204, 204);">EventThreadConnection</span><span style="background-color: rgb(255, 255, 255);">(</span></span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">const_cast</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">&lt;EventThread*&gt;(</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">this</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">),<br />                                     IPCThreadState::self()-&gt;getCallingUid(),<br />                                     std::move(resyncCallback), eventRegistration);<br />}</span></font></pre></pre></pre></pre></pre></div></div></pre></pre></pre></pre></div></div></div></foreignObject><text x="3715" y="2442" fill="rgb(0, 0, 0)" font-family="Courier New" font-size="12px">// aosp_android-12.1.0_r2\frameworks\native\services\surfaceflinger\Scheduler\EventThread.cppsp&lt;EventThrea...</text></switch></g><path d="M 3280 2514 Q 3310 2514 3495 2472 Q 3680 2430 3703.63 2430" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 3708.88 2430 L 3701.88 2433.5 L 3703.63 2430 L 3701.88 2426.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><ellipse cx="3275" cy="2514" rx="5" ry="5" fill="#000000" stroke="none" pointer-events="all"/><rect x="4390" y="2430" width="640" height="170" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 637px; height: 1px; padding-top: 2430px; margin-left: 4395px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: &quot;Courier New&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><pre style=""><pre style=""><pre style=""><pre style=""><div style="line-height: 16px;"><div style=""><pre style=""><pre style=""><pre style=""><pre style=""><pre style=""><pre style=""><font face="Consolas, monospace" color="#cccccc" style="background-color: rgb(255, 255, 255);"><span style="font-size: 11.0667px;">// aosp_android-12.1.0_r2\frameworks\native\services\surfaceflinger\Scheduler\EventThread.cpp</span><span style="font-size: 8.3pt;"><br /></span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">EventThreadConnection</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 98, 122); font-family: Consolas, monospace; font-size: 8.3pt;">EventThreadConnection</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">(<br />        </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">EventThread</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">* eventThread, </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(55, 31, 128); font-family: Consolas, monospace; font-size: 8.3pt;">uid_t </span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">callingUid, </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(55, 31, 128); font-family: Consolas, monospace; font-size: 8.3pt;">ResyncCallback </span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">resyncCallback,<br />        </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">ISurfaceComposer</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(55, 31, 128); font-family: Consolas, monospace; font-size: 8.3pt;">EventRegistrationFlags </span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">eventRegistration)<br />      : </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">resyncCallback</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">(</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">std</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::move(resyncCallback)),<br />        </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">mOwnerUid</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">(callingUid),<br />        </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">mEventRegistration</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">(eventRegistration),<br />        </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">mEventThread</span><font color="#080808" face="Consolas, monospace" style=""><span style="font-size: 8.3pt;"><span style="background-color: rgb(255, 255, 255);">(eventThread),<br />        </span><span style="background-color: rgb(204, 204, 204);">mChannel</span><span style="background-color: rgb(255, 255, 255);">(gui::BitTube::DefaultSize) {}</span></span></font></pre></pre></pre></pre></pre></pre></div></div></pre></pre></pre></pre></div></div></div></foreignObject><text x="4395" y="2442" fill="rgb(0, 0, 0)" font-family="Courier New" font-size="12px">// aosp_android-12.1.0_r2\frameworks\native\services\surfaceflinger\Scheduler\EventThread.cppEventThreadCo...</text></switch></g><path d="M 3950 2514 Q 3980 2514 4170 2472 Q 4360 2430 4383.63 2430" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 4388.88 2430 L 4381.88 2433.5 L 4383.63 2430 L 4381.88 2426.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><ellipse cx="3945" cy="2514" rx="5" ry="5" fill="#000000" stroke="none" pointer-events="all"/><rect x="5080" y="2519" width="540" height="330" fill="rgb(255, 255, 255)" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 537px; height: 1px; padding-top: 2519px; margin-left: 5085px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: &quot;Courier New&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><pre style=""><pre style=""><pre style=""><pre style=""><pre style=""><pre style=""><pre style=""><div style="line-height: 16px;"><div style="line-height: 16px;"><div style="line-height: 16px;"><div style="line-height: 16px;"><div style="line-height: 16px;"><div style="line-height: 16px;"><div style="font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 12px;"><span style="color: #3f7f5f;">// frameworks\native\libs\gui\BitTube.cpp</span></div><div style=""><span style="white-space: normal; font-family: Consolas, &quot;Courier New&quot;, monospace; color: rgb(127, 0, 85); font-weight: bold;">void</span><font face="Consolas, Courier New, monospace" style="white-space: normal;"> BitTube::init(</font><span style="white-space: normal; font-family: Consolas, &quot;Courier New&quot;, monospace; color: rgb(127, 0, 85); font-weight: bold;">size_t</span><font face="Consolas, Courier New, monospace" style="white-space: normal;"> rcvbuf, </font><span style="white-space: normal; font-family: Consolas, &quot;Courier New&quot;, monospace; color: rgb(127, 0, 85); font-weight: bold;">size_t</span><font face="Consolas, Courier New, monospace" style="white-space: normal;"> sndbuf) {</font><br /></div><div style=""><span style="font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 12px;">    </span><span style="font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(127, 0, 85); font-weight: bold;">int</span><span style="font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 12px;"> </span><span style="font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(106, 62, 62);">sockets</span><font face="Consolas, Courier New, monospace" style="">[2];</font></div><div style=""><font style=""><div><span style="white-space: normal; font-family: Consolas, &quot;Courier New&quot;, monospace;">    </span><span style="white-space: normal; font-family: Consolas, &quot;Courier New&quot;, monospace; color: rgb(127, 0, 85); font-weight: bold;">if</span><span style="white-space: normal; font-family: Consolas, &quot;Courier New&quot;, monospace;"> (<span style="">socketpair(AF_UNIX, SOCK_SEQPACKET, 0, sockets) </span>== 0) {</span><br /></div></font></div><div style="font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 12px;">        <span style="color: #7f0055;font-weight: bold;">size_t</span> size = DEFAULT_SOCKET_BUFFER_SIZE;</div><div style="font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 12px;">        setsockopt(<span style="color: #6a3e3e;">sockets</span>[0], SOL_SOCKET, SO_RCVBUF, &amp;rcvbuf, <span style="color: #7f0055;font-weight: bold;">sizeof</span>(rcvbuf));</div><div style="font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 12px;">        setsockopt(<span style="color: #6a3e3e;">sockets</span>[1], SOL_SOCKET, SO_SNDBUF, &amp;sndbuf, <span style="color: #7f0055;font-weight: bold;">sizeof</span>(sndbuf));</div><div style="font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 12px;"><span style="color: #3f7f5f;">        // since we don't use the "return channel", we keep it small...</span></div><div style="font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 12px;">        setsockopt(<span style="color: #6a3e3e;">sockets</span>[0], SOL_SOCKET, SO_SNDBUF, &amp;size, <span style="color: #7f0055;font-weight: bold;">sizeof</span>(size));</div><div style="font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 12px;">        setsockopt(<span style="color: #6a3e3e;">sockets</span>[1], SOL_SOCKET, SO_RCVBUF, &amp;size, <span style="color: #7f0055;font-weight: bold;">sizeof</span>(size));</div><div style="font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 12px;">        fcntl(<span style="color: #6a3e3e;">sockets</span>[0], F_SETFL, O_NONBLOCK);</div><div style="font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 12px;">        fcntl(<span style="color: #6a3e3e;">sockets</span>[1], F_SETFL, O_NONBLOCK);</div><div style=""><span style="white-space: normal; font-family: Consolas, &quot;Courier New&quot;, monospace;">        </span><span style="white-space: normal; font-family: Consolas, &quot;Courier New&quot;, monospace; color: rgb(106, 62, 62);">mReceiveFd</span><span style="white-space: normal; font-family: Consolas, &quot;Courier New&quot;, monospace;">.reset(</span><span style="white-space: normal; font-family: Consolas, &quot;Courier New&quot;, monospace; color: rgb(106, 62, 62);">sockets</span><span style="white-space: normal; font-family: Consolas, &quot;Courier New&quot;, monospace;">[0]);</span><br /></div><div style="font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 12px;"><span style="">        </span><span style="color: rgb(106, 62, 62);">mSendFd</span><span style="">.reset(</span><span style="color: rgb(106, 62, 62);">sockets</span><span style="">[1]);</span></div><div style="font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 12px;">    } <span style="color: #7f0055;font-weight: bold;">else</span> {</div><div style="font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 12px;">        <span style="color: #6a3e3e;">mReceiveFd</span>.reset();</div><div style="font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 12px;">        ALOGE(<span style="color: #2a00ff;">"BitTube: pipe creation failed (</span><span style="color: #6a3e3e;">%s</span><span style="color: #2a00ff;">)"</span>, strerror(errno));</div><div style="font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 12px;">    }</div><div style="font-family: Consolas, &quot;Courier New&quot;, monospace; font-size: 12px;">}</div></div></div></div></div></div></div></pre></pre></pre></pre></pre></pre></pre></div></div></div></foreignObject><text x="5085" y="2531" fill="rgb(0, 0, 0)" font-family="Courier New" font-size="12px">// frameworks\native\libs\gui\BitTube.cpp...</text></switch></g><path d="M 4500 2575 Q 4530 2575 4785 2502 Q 5040 2429 5063.63 2429" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 5068.88 2429 L 5061.88 2432.5 L 5063.63 2429 L 5061.88 2425.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><ellipse cx="4495" cy="2575" rx="5" ry="5" fill="#000000" stroke="none" pointer-events="all"/><rect x="40" y="650" width="680" height="1270" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 677px; height: 1px; padding-top: 650px; margin-left: 45px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: &quot;Courier New&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><pre style=""><pre style=""><pre style=""><pre style=""><div style="line-height: 16px;"><div style=""><pre style="font-family: Consolas, monospace; font-size: 8.3pt;"><font color="#cccccc" style="background-color: rgb(255, 255, 255);">// aosp_android-12.1.0_r2\frameworks\native\services\surfaceflinger\SurfaceFlinger.cpp<br /></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">void </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">SurfaceFlinger</span><font color="#080808" style="background-color: rgb(255, 255, 255);">::</font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 98, 122);">processDisplayAdded</span><font color="#080808" style="background-color: rgb(255, 255, 255);">(</font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">const </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">wp</span><font color="#080808" style="background-color: rgb(255, 255, 255);">&lt;</font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">IBinder</span><font color="#080808" style="background-color: rgb(255, 255, 255);">&gt;&amp; displayToken,<br />                                         </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">const </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">DisplayDeviceState</span><font color="#080808" style="background-color: rgb(255, 255, 255);">&amp; state) {<br />    </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">ui</span><font color="#080808" style="background-color: rgb(255, 255, 255);">::</font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">Size </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">resolution</span><font color="#080808" style="background-color: rgb(255, 255, 255);">(</font><span style="background-color: rgb(255, 255, 255); color: rgb(23, 80, 235);">0</span><font color="#080808" style="background-color: rgb(255, 255, 255);">, </font><span style="background-color: rgb(255, 255, 255); color: rgb(23, 80, 235);">0</span><font color="#080808" style="background-color: rgb(255, 255, 255);">);<br />    ui::PixelFormat </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">pixelFormat </span><font color="#080808" style="background-color: rgb(255, 255, 255);">= </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">static_cast</span><font color="#080808" style="background-color: rgb(255, 255, 255);">&lt;ui::PixelFormat&gt;(PIXEL_FORMAT_UNKNOWN);<br />    </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">if </span><font color="#080808" style="background-color: rgb(255, 255, 255);">(state.physical) {<br />        </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">resolution </span><font color="#080808" style="background-color: rgb(255, 255, 255);">= state.physical-&gt;</font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">activeMode</span><font color="#080808" style="background-color: rgb(255, 255, 255);">-&gt;</font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">getSize</span><font color="#080808" style="background-color: rgb(255, 255, 255);">();<br />        pixelFormat = </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">static_cast</span><font color="#080808" style="background-color: rgb(255, 255, 255);">&lt;ui::PixelFormat&gt;(PIXEL_FORMAT_RGBA_8888);<br />    } </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">else if </span><font color="#080808" style="background-color: rgb(255, 255, 255);">(state.</font><span style="background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">surface </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">!= </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">nullptr</span><font color="#080808" style="background-color: rgb(255, 255, 255);">) {<br />        </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">int </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">status </span><font color="#080808" style="background-color: rgb(255, 255, 255);">= state.</font><span style="background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">surface</span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">-&gt;</span><font color="#080808" style="background-color: rgb(255, 255, 255);">query(</font><span style="background-color: rgb(255, 255, 255); color: rgb(135, 16, 148); font-style: italic;">NATIVE_WINDOW_WIDTH</span><font color="#080808" style="background-color: rgb(255, 255, 255);">, &amp;</font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">resolution</span><font color="#080808" style="background-color: rgb(255, 255, 255);">.</font><span style="background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">width</span><font color="#080808" style="background-color: rgb(255, 255, 255);">);<br />        </font><span style="background-color: rgb(255, 255, 255); color: rgb(31, 84, 46); font-weight: bold;">ALOGE_IF</span><font color="#080808" style="background-color: rgb(255, 255, 255);">(</font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">status </span><font color="#080808" style="background-color: rgb(255, 255, 255);">!= NO_ERROR, </font><span style="background-color: rgb(255, 255, 255); color: rgb(6, 125, 23);">"Unable to query width (%d)"</span><font color="#080808" style="background-color: rgb(255, 255, 255);">, </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">status</span><font color="#080808" style="background-color: rgb(255, 255, 255);">);<br />        </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">status </span><font color="#080808" style="background-color: rgb(255, 255, 255);">= state.</font><span style="background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">surface</span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">-&gt;</span><font color="#080808" style="background-color: rgb(255, 255, 255);">query(</font><span style="background-color: rgb(255, 255, 255); color: rgb(135, 16, 148); font-style: italic;">NATIVE_WINDOW_HEIGHT</span><font color="#080808" style="background-color: rgb(255, 255, 255);">, &amp;</font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">resolution</span><font color="#080808" style="background-color: rgb(255, 255, 255);">.</font><span style="background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">height</span><font color="#080808" style="background-color: rgb(255, 255, 255);">);<br />        </font><span style="background-color: rgb(255, 255, 255); color: rgb(31, 84, 46); font-weight: bold;">ALOGE_IF</span><font color="#080808" style="background-color: rgb(255, 255, 255);">(</font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">status </span><font color="#080808" style="background-color: rgb(255, 255, 255);">!= NO_ERROR, </font><span style="background-color: rgb(255, 255, 255); color: rgb(6, 125, 23);">"Unable to query height (%d)"</span><font color="#080808" style="background-color: rgb(255, 255, 255);">, </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">status</span><font color="#080808" style="background-color: rgb(255, 255, 255);">);<br />        </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">int </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">format</span><font color="#080808" style="background-color: rgb(255, 255, 255);">;<br />        </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">status </span><font color="#080808" style="background-color: rgb(255, 255, 255);">= state.</font><span style="background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">surface</span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">-&gt;</span><font color="#080808" style="background-color: rgb(255, 255, 255);">query(</font><span style="background-color: rgb(255, 255, 255); color: rgb(135, 16, 148); font-style: italic;">NATIVE_WINDOW_FORMAT</span><font color="#080808" style="background-color: rgb(255, 255, 255);">, &amp;</font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">format</span><font color="#080808" style="background-color: rgb(255, 255, 255);">);<br />        </font><span style="background-color: rgb(255, 255, 255); color: rgb(31, 84, 46); font-weight: bold;">ALOGE_IF</span><font color="#080808" style="background-color: rgb(255, 255, 255);">(</font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">status </span><font color="#080808" style="background-color: rgb(255, 255, 255);">!= NO_ERROR, </font><span style="background-color: rgb(255, 255, 255); color: rgb(6, 125, 23);">"Unable to query format (%d)"</span><font color="#080808" style="background-color: rgb(255, 255, 255);">, </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">status</span><font color="#080808" style="background-color: rgb(255, 255, 255);">);<br />        pixelFormat = </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">static_cast</span><font color="#080808" style="background-color: rgb(255, 255, 255);">&lt;ui::PixelFormat&gt;(format);<br />    } </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">else </span><font color="#080808" style="background-color: rgb(255, 255, 255);">{<br />        </font><span style="background-color: rgb(255, 255, 255); color: rgb(140, 140, 140); font-style: italic;">// Virtual displays without a surface are dormant:<br /></span><span style="background-color: rgb(255, 255, 255); color: rgb(140, 140, 140); font-style: italic;">        // they have external state (layer stack, projection,<br /></span><span style="background-color: rgb(255, 255, 255); color: rgb(140, 140, 140); font-style: italic;">        // etc.) but no internal state (i.e. a DisplayDevice).<br /></span><span style="background-color: rgb(255, 255, 255); color: rgb(140, 140, 140); font-style: italic;">        </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">return</span><font color="#080808" style="background-color: rgb(255, 255, 255);">;<br />    }<br /><br />    </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">compositionengine</span><font color="#080808" style="background-color: rgb(255, 255, 255);">::</font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">DisplayCreationArgsBuilder </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">builder</span><font color="#080808" style="background-color: rgb(255, 255, 255);">;<br />    </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">if </span><font color="#080808" style="background-color: rgb(255, 255, 255);">(</font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">const auto</span><font color="#080808" style="background-color: rgb(255, 255, 255);">&amp; physical = state.physical) {<br />        builder.setId(physical-&gt;id);<br />        builder.setConnectionType(physical-&gt;type);<br />    } </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">else </span><font color="#080808" style="background-color: rgb(255, 255, 255);">{<br />        builder.setId(acquireVirtualDisplay(resolution, pixelFormat));<br />    }<br /><br />    </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">builder</span><font color="#080808" style="background-color: rgb(255, 255, 255);">.setPixels(</font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">resolution</span><font color="#080808" style="background-color: rgb(255, 255, 255);">);<br />    </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">builder</span><font color="#080808" style="background-color: rgb(255, 255, 255);">.setIsSecure(state.</font><span style="background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">isSecure</span><font color="#080808" style="background-color: rgb(255, 255, 255);">);<br />    </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">builder</span><font color="#080808" style="background-color: rgb(255, 255, 255);">.setLayerStackId(state.layerStack);<br />    builder.setPowerAdvisor(&amp;mPowerAdvisor);<br />    </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">builder</span><font color="#080808" style="background-color: rgb(255, 255, 255);">.setName(state.</font><span style="background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">displayName</span><font color="#080808" style="background-color: rgb(255, 255, 255);">);<br />    </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">auto </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">compositionDisplay </span><font color="#080808" style="background-color: rgb(255, 255, 255);">= getCompositionEngine().createDisplay(</font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">builder</span><font color="#080808" style="background-color: rgb(255, 255, 255);">.build());<br />    </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">compositionDisplay</span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">-&gt;</span><font color="#080808" style="background-color: rgb(255, 255, 255);">setLayerCachingEnabled(</font><span style="background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">mLayerCachingEnabled</span><font color="#080808" style="background-color: rgb(255, 255, 255);">);<br /><br />    </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">sp</span><font color="#080808" style="background-color: rgb(255, 255, 255);">&lt;</font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">compositionengine</span><font color="#080808" style="background-color: rgb(255, 255, 255);">::</font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">DisplaySurface</span><font color="#080808" style="background-color: rgb(255, 255, 255);">&gt; </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">displaySurface</span><font color="#080808" style="background-color: rgb(255, 255, 255);">;<br />    </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">sp</span><font color="#080808" style="background-color: rgb(255, 255, 255);">&lt;</font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">IGraphicBufferProducer</span><font color="#080808" style="background-color: rgb(255, 255, 255);">&gt; </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">producer</span><font color="#080808" style="background-color: rgb(255, 255, 255);">;<br />    </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">sp</span><font color="#080808" style="background-color: rgb(255, 255, 255);">&lt;</font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">IGraphicBufferProducer</span><font color="#080808" style="background-color: rgb(255, 255, 255);">&gt; </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">bqProducer</span><font color="#080808" style="background-color: rgb(255, 255, 255);">;<br />    </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">sp</span><font color="#080808" style="background-color: rgb(255, 255, 255);">&lt;</font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">IGraphicBufferConsumer</span><font color="#080808" style="background-color: rgb(255, 255, 255);">&gt; </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">bqConsumer</span><font color="#080808" style="background-color: rgb(255, 255, 255);">;<br />    getFactory().createBufferQueue(&amp;</font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">bqProducer</span><font color="#080808" style="background-color: rgb(255, 255, 255);">, &amp;</font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">bqConsumer</span><font color="#080808" style="background-color: rgb(255, 255, 255);">, </font><span style="background-color: rgb(255, 255, 255); color: rgb(140, 140, 140); font-style: italic;">/*consumerIsSurfaceFlinger =*/</span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">false</span><font color="#080808" style="background-color: rgb(255, 255, 255);">);<br /><br />    </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">if </span><font color="#080808" style="background-color: rgb(255, 255, 255);">(state.isVirtual()) {<br />        </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">const auto </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">displayId </span><font color="#080808" style="background-color: rgb(255, 255, 255);">= VirtualDisplayId::tryCast(compositionDisplay-&gt;getId());<br />        </font><span style="background-color: rgb(255, 255, 255); color: rgb(31, 84, 46); font-weight: bold;">LOG_FATAL_IF</span><font color="#080808" style="background-color: rgb(255, 255, 255);">(!displayId);<br />        </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">auto </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">surface </span><font color="#080808" style="background-color: rgb(255, 255, 255);">= sp&lt;VirtualDisplaySurface&gt;::make(getHwComposer(), *displayId, state.surface,<br />                                                       bqProducer, bqConsumer, state.displayName);<br />        displaySurface = surface;<br />        producer = std::move(surface);<br />    } </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">else </span><font color="#080808" style="background-color: rgb(255, 255, 255);">{<br />        </font><span style="background-color: rgb(255, 255, 255); color: rgb(31, 84, 46); font-weight: bold;">ALOGE_IF</span><font color="#080808" style="background-color: rgb(255, 255, 255);">(state.</font><span style="background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">surface </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">!= </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">nullptr</span><font color="#080808" style="background-color: rgb(255, 255, 255);">,<br />                 </font><span style="background-color: rgb(255, 255, 255); color: rgb(6, 125, 23);">"adding a supported display, but rendering "<br /></span><span style="background-color: rgb(255, 255, 255); color: rgb(6, 125, 23);">                 "surface is provided (%p), ignoring it"</span><font color="#080808" style="background-color: rgb(255, 255, 255);">,<br />                 state.</font><span style="background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">surface</span><font color="#080808" style="background-color: rgb(255, 255, 255);">.get());<br />        </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">const auto </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">displayId </span><font color="#080808" style="background-color: rgb(255, 255, 255);">= PhysicalDisplayId::tryCast(compositionDisplay-&gt;getId());<br />        </font><span style="background-color: rgb(255, 255, 255); color: rgb(31, 84, 46); font-weight: bold;">LOG_FATAL_IF</span><font color="#080808" style="background-color: rgb(255, 255, 255);">(!displayId);<br />        displaySurface =<br />                sp&lt;FramebufferSurface&gt;::make(getHwComposer(), *displayId, bqConsumer,<br />                                             state.physical-&gt;activeMode-&gt;getSize(),<br />                                             ui::Size(maxGraphicsWidth, maxGraphicsHeight));<br />        </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">producer </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">= </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">bqProducer</span><font color="#080808" style="background-color: rgb(255, 255, 255);">;<br />    }<br /><br />    </font><span style="background-color: rgb(255, 255, 255); color: rgb(31, 84, 46); font-weight: bold;">LOG_FATAL_IF</span><font color="#080808" style="background-color: rgb(255, 255, 255);">(!</font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">displaySurface</span><font color="#080808" style="background-color: rgb(255, 255, 255);">);<br />    </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">const auto </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">display </span><font color="#080808" style="background-color: rgb(255, 255, 255);">= </font><font color="#080808" style="background-color: rgb(204, 204, 204);">setupNewDisplayDeviceInternal</font><font color="#080808" style="background-color: rgb(255, 255, 255);">(displayToken, </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">std</span><font color="#080808" style="background-color: rgb(255, 255, 255);">::move(</font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">compositionDisplay</span><font color="#080808" style="background-color: rgb(255, 255, 255);">),<br />                                                       state, </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">displaySurface</span><font color="#080808" style="background-color: rgb(255, 255, 255);">, </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">producer</span><font color="#080808" style="background-color: rgb(255, 255, 255);">);<br />    </font><span style="background-color: rgb(255, 255, 255); color: rgb(102, 14, 122);">mDisplays</span><font color="#080808" style="background-color: rgb(255, 255, 255);">.emplace(displayToken, </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">display</span><font color="#080808" style="background-color: rgb(255, 255, 255);">);<br />    </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">if </span><font color="#080808" style="background-color: rgb(255, 255, 255);">(</font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">display</span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128);">-&gt;</span><font color="#080808" style=""><span style="background-color: rgb(255, 255, 255);">isPrimary()) {<br />        </span><span style="background-color: rgb(204, 204, 204);">initScheduler</span><span style="background-color: rgb(255, 255, 255);">(</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0);">display</span><font color="#080808" style="background-color: rgb(255, 255, 255);">);<br />    }<br />    </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">if </span><font color="#080808" style="background-color: rgb(255, 255, 255);">(!state.isVirtual()) {<br />        dispatchDisplayHotplugEvent(display-&gt;getPhysicalId(), </font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179);">true</span><font color="#080808" style="background-color: rgb(255, 255, 255);">);<br />    }<br />}</font></pre></div></div></pre></pre></pre></pre></div></div></div></foreignObject><text x="45" y="662" fill="rgb(0, 0, 0)" font-family="Courier New" font-size="12px">// aosp_android-12.1.0_r2\frameworks\native\services\surfaceflinger\SurfaceFlinger.cpp...</text></switch></g><rect x="790" y="680" width="700" height="570" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 697px; height: 1px; padding-top: 680px; margin-left: 795px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: &quot;Courier New&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><pre style=""><pre style=""><pre style=""><pre style=""><div style="line-height: 16px;"><div style=""><pre style=""><pre style=""><font face="Consolas, monospace" color="#cccccc" style="background-color: rgb(255, 255, 255);"><span style="font-size: 11.0667px;">// aosp_android-12.1.0_r2\frameworks\native\services\surfaceflinger\SurfaceFlinger.cpp</span><span style="font-size: 8.3pt;"><br /></span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">sp</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">&lt;</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">DisplayDevice</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">&gt; </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">SurfaceFlinger</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 98, 122); font-family: Consolas, monospace; font-size: 8.3pt;">setupNewDisplayDeviceInternal</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">(<br />        </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">const </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">wp</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">&lt;</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">IBinder</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">&gt;&amp; displayToken,<br />        </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">std</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">shared_ptr</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">&lt;</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">compositionengine</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">Display</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">&gt; compositionDisplay,<br />        </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">const </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">DisplayDeviceState</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">&amp; state,<br />        </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">const </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">sp</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">&lt;</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">compositionengine</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">DisplaySurface</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">&gt;&amp; displaySurface,<br />        </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">const </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">sp</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">&lt;</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">IGraphicBufferProducer</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">&gt;&amp; producer) {<br />    </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">DisplayDeviceCreationArgs </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">creationArgs</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">(</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">this</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">, getHwComposer(), displayToken, compositionDisplay);<br />    </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">creationArgs</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">.</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">sequenceId </span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">= state.</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">sequenceId</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">;<br />    </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">creationArgs</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">.</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">isSecure </span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">= state.</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">isSecure</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">;<br />    </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">creationArgs</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">.</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">displaySurface </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">= </span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">displaySurface;<br />    </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">creationArgs</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">.</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">hasWideColorGamut </span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">= </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">false</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">;<br />    </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">creationArgs</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">.</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">supportedPerFrameMetadata </span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">= </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(23, 80, 235); font-family: Consolas, monospace; font-size: 8.3pt;">0</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">;<br /><br />    </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">if </span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">(</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">const auto</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">&amp; physical = state.physical) {<br />        creationArgs.connectionType = physical-&gt;type;<br />        creationArgs.supportedModes = physical-&gt;supportedModes;<br />        creationArgs.activeModeId = physical-&gt;activeMode-&gt;getId();<br />        </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">const auto </span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">[</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">idleTimerTimeoutMs</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">, </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">supportKernelIdleTimer</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">] =<br />                getIdleTimerConfiguration(compositionDisplay-&gt;getId());<br />        </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">scheduler</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">RefreshRateConfigs</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">Config </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">config </span><span style="background-color: rgb(255, 255, 255); color: rgb(8, 8, 8); font-family: Consolas, monospace; font-size: 8.3pt;">=<br /></span><span style="background-color: rgb(255, 255, 255); font-size: 11.0667px;"><font face="consolas" style="" color="#ff0000"><i style="">                // 获取 ro.surface_flinger.enable_frame_rate_override 属性值，当前系统为空，取默认值 false<br /></i></font></span><span style="background-color: rgb(255, 255, 255); color: rgb(8, 8, 8); font-family: Consolas, monospace; font-size: 8.3pt;">                {.enableFrameRateOverride = android::sysprop::enable_frame_rate_override(</span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">false</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">),<br />                 .frameRateMultipleThreshold =<br />                         base::GetIntProperty(</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(6, 125, 23); font-family: Consolas, monospace; font-size: 8.3pt;">"debug.sf.frame_rate_multiple_threshold"</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">, </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(23, 80, 235); font-family: Consolas, monospace; font-size: 8.3pt;">0</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">),<br />                 .idleTimerTimeoutMs = idleTimerTimeoutMs,<br />                 .supportKernelIdleTimer = supportKernelIdleTimer};<br />        </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">creationArgs</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">.</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">refreshRateConfigs </span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">=<br />                </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">std</span><font color="#080808" face="Consolas, monospace" style=""><span style="font-size: 8.3pt;"><span style="background-color: rgb(255, 255, 255);">::</span><span style="background-color: rgb(204, 204, 204);">make_shared&lt;</span></span></font><span style="background-color: rgb(204, 204, 204);"><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">scheduler</span><font color="#080808" face="Consolas, monospace" style=""><span style="font-size: 8.3pt;">::</span></font><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">RefreshRateConfigs</span></span><font color="#080808" face="Consolas, monospace" style=""><span style="font-size: 8.3pt;"><span style="background-color: rgb(204, 204, 204);">&gt;</span><span style="background-color: rgb(255, 255, 255);">(</span></span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">creationArgs</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">.</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">supportedModes</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">,<br />                                                                </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">creationArgs</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">.activeModeId, </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">config</span><font face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;"><font color="#080808">);<br />    }<br />    </font><font color="#0033b3">...</font></span></font><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;"><br />    </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">return </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">display</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">;<br />}</span></font></pre></pre></div></div></pre></pre></pre></pre></div></div></div></foreignObject><text x="795" y="692" fill="rgb(0, 0, 0)" font-family="Courier New" font-size="12px">// aosp_android-12.1.0_r2\frameworks\native\services\surfaceflinger\SurfaceFlinger.cppsp&lt;DisplayDevice&gt; SurfaceFling...</text></switch></g><path d="M 180 1815 Q 210 1815 485 1792.5 Q 760 1770 783.63 1770" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 788.88 1770 L 781.88 1773.5 L 783.63 1770 L 781.88 1766.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><ellipse cx="175" cy="1815" rx="5" ry="5" fill="#000000" stroke="none" pointer-events="all"/><path d="M 385 1755 Q 415 1755 587.5 1217.5 Q 760 680 783.63 680" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 788.88 680 L 781.88 683.5 L 783.63 680 L 781.88 676.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><ellipse cx="380" cy="1755" rx="5" ry="5" fill="#000000" stroke="none" pointer-events="all"/><rect x="1550" y="680" width="680" height="140" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 677px; height: 1px; padding-top: 680px; margin-left: 1555px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: &quot;Courier New&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><pre style=""><pre style=""><pre style=""><pre style=""><div style="line-height: 16px;"><div style=""><pre style=""><pre style=""><pre style=""><font face="Consolas, monospace" color="#cccccc" style="background-color: rgb(255, 255, 255);"><span style="font-size: 11.0667px;">// aosp_android-12.1.0_r2\frameworks\native\services\surfaceflinger\Scheduler\RefreshRateConfigs.cpp</span><span style="font-size: 8.3pt;"><br /></span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">RefreshRateConfigs</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 98, 122); font-family: Consolas, monospace; font-size: 8.3pt;">RefreshRateConfigs</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">(</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">const </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">DisplayModes</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">&amp; modes, </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">DisplayModeId </span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">currentModeId,<br />                                       </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">Config </span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">config)<br />      : mKnownFrameRates(constructKnownFrameRates(modes)), </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">mConfig</span><font color="#080808" face="Consolas, monospace" style=""><span style="font-size: 8.3pt;"><span style="background-color: rgb(255, 255, 255);">(config) {<br />    initializeIdleTimer();<br />    </span><span style="background-color: rgb(204, 204, 204);">updateDisplayModes</span><span style="background-color: rgb(255, 255, 255);">(modes, currentModeId);<br />}</span></span></font></pre></pre></pre></div></div></pre></pre></pre></pre></div></div></div></foreignObject><text x="1555" y="692" fill="rgb(0, 0, 0)" font-family="Courier New" font-size="12px">// aosp_android-12.1.0_r2\frameworks\native\services\surfaceflinger\Scheduler\RefreshRateConfigs.cppRefreshRateCo...</text></switch></g><path d="M 1200 1145 Q 1230 1145 1375 912.5 Q 1520 680 1543.63 680" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 1548.88 680 L 1541.88 683.5 L 1543.63 680 L 1541.88 676.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><ellipse cx="1195" cy="1145" rx="5" ry="5" fill="#000000" stroke="none" pointer-events="all"/><rect x="2270" y="680" width="690" height="780" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 687px; height: 1px; padding-top: 680px; margin-left: 2275px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: &quot;Courier New&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><pre style=""><pre style=""><pre style=""><pre style=""><div style="line-height: 16px;"><div style=""><pre style=""><pre style=""><pre style="background-color: rgb(255, 255, 255);"><pre style=""><font face="Consolas, monospace" color="#cccccc"><span style="font-size: 11.0667px;">// aosp_android-12.1.0_r2\frameworks\native\services\surfaceflinger\Scheduler\RefreshRateConfigs.cpp</span><span style="font-size: 8.3pt;"><br /></span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">void </span><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">RefreshRateConfigs</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">::</span></font><span style="color: rgb(0, 98, 122); font-family: Consolas, monospace; font-size: 8.3pt;">updateDisplayModes</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">(</span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">const </span><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">DisplayModes</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">&amp; modes,<br />                                            </span></font><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">DisplayModeId </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">currentModeId) {<br />    std::lock_guard lock(mLock);<br /><br />    </span></font><span style="color: rgb(140, 140, 140); font-family: Consolas, monospace; font-size: 8.3pt; font-style: italic;">// The current mode should be supported<br /></span><span style="color: rgb(140, 140, 140); font-family: Consolas, monospace; font-size: 8.3pt; font-style: italic;">    </span><span style="color: rgb(31, 84, 46); font-family: Consolas, monospace; font-size: 8.3pt; font-weight: bold;">LOG_ALWAYS_FATAL_IF</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">(std::none_of(modes.begin(), modes.end(), [&amp;](DisplayModePtr mode) {<br />        </span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">return </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">mode-&gt;getId() == currentModeId;<br />    }));<br /><br />    </span></font><span style="color: rgb(140, 140, 140); font-family: Consolas, monospace; font-size: 8.3pt; font-style: italic;">// Invalidate the cached invocation to getBestRefreshRate. This forces<br /></span><span style="color: rgb(140, 140, 140); font-family: Consolas, monospace; font-size: 8.3pt; font-style: italic;">    // the refresh rate to be recomputed on the next call to getBestRefreshRate.<br /></span><span style="color: rgb(140, 140, 140); font-family: Consolas, monospace; font-size: 8.3pt; font-style: italic;">    </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">lastBestRefreshRateInvocation.reset();<br /><br />    mRefreshRates.clear();<br />    </span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">for </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">(</span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">const auto</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">&amp; mode : modes) {<br />        </span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">const auto </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">modeId = mode-&gt;getId();<br />        mRefreshRates.emplace(modeId,<br />                              std::make_unique&lt;RefreshRate&gt;(mode, RefreshRate::ConstructorTag(</span></font><span style="color: rgb(23, 80, 235); font-family: Consolas, monospace; font-size: 8.3pt;">0</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">)));<br />        </span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">if </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">(modeId == currentModeId) {<br />            mCurrentRefreshRate = mRefreshRates.at(modeId).get();<br />        }<br />    }<br /><br />    </span></font><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">std</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">::</span></font><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">vector</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">&lt;</span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">const </span><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">RefreshRate</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">*&gt; </span></font><span style="color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">sortedModes</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">;<br />    getSortedRefreshRateListLocked([](</span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">const </span><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">RefreshRate</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">&amp;) { </span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">return true</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">; }, &amp;</span></font><span style="color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">sortedModes</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">);<br />    </span></font><span style="color: rgb(140, 140, 140); font-family: Consolas, monospace; font-size: 8.3pt; font-style: italic;">// Reset the policy because the old one may no longer be valid.<br /></span><span style="color: rgb(140, 140, 140); font-family: Consolas, monospace; font-size: 8.3pt; font-style: italic;">    </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">mDisplayManagerPolicy = {};<br />    mDisplayManagerPolicy.defaultMode = currentModeId;<br />    </span></font><span style="color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">mMinSupportedRefreshRate </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">= </span></font><span style="color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">sortedModes</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">.front();<br />    </span></font><span style="color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">mMaxSupportedRefreshRate </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">= </span></font><span style="color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">sortedModes</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">.back();<br /><br />    </span></font><span style="color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">mSupportsFrameRateOverride </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">= </span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">false</span><span style="color: rgb(8, 8, 8); font-family: Consolas, monospace; font-size: 8.3pt;">;<br /></span><span style="font-size: 11.0667px;"><font face="consolas" style="" color="#ff0000"><i style="">    // mConfig.enableFrameRateOverride 取自 ro.surface_flinger.enable_frame_rate_override，默认为 false<br /></i></font></span><span style="color: rgb(8, 8, 8); font-family: Consolas, monospace; font-size: 8.3pt;">    </span><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">if </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">(</span></font><span style="color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">mConfig</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">.</span></font><span style="color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">enableFrameRateOverride</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">) {<br />        </span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">for </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">(</span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">const auto</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">&amp; </span></font><span style="color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">mode1 </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">: </span></font><span style="color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">sortedModes</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">) {<br />            </span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">for </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">(</span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">const auto</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">&amp; </span></font><span style="color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">mode2 </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">: </span></font><span style="color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">sortedModes</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">) {<br />                </span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">if </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">(getFrameRateDivider(mode1-&gt;getFps(), mode2-&gt;getFps()) &gt;= </span></font><span style="color: rgb(23, 80, 235); font-family: Consolas, monospace; font-size: 8.3pt;">2</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">) {<br />                    </span></font><span style="color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">mSupportsFrameRateOverride </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">= </span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">true</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">;<br />                    </span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">break</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">;<br />                }<br />            }<br />        }<br />    }<br /><br />    constructAvailableRefreshRates();<br />}</span></font></pre></pre></pre></pre></div></div></pre></pre></pre></pre></div></div></div></foreignObject><text x="2275" y="692" fill="rgb(0, 0, 0)" font-family="Courier New" font-size="12px">// aosp_android-12.1.0_r2\frameworks\native\services\surfaceflinger\Scheduler\RefreshRateConfigs.cppvoid RefreshRat...</text></switch></g><path d="M 1690 785 Q 1720 785 1980 732.5 Q 2240 680 2263.63 680" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2268.88 680 L 2261.88 683.5 L 2263.63 680 L 2261.88 676.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><ellipse cx="1685" cy="785" rx="5" ry="5" fill="#000000" stroke="none" pointer-events="all"/><rect x="2270" y="1520" width="620" height="220" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 617px; height: 1px; padding-top: 1520px; margin-left: 2275px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: &quot;Courier New&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><pre style=""><pre style=""><pre style=""><pre style=""><div style="line-height: 16px;"><div style=""><pre style=""><pre style=""><pre style=""><font face="Consolas, monospace" color="#cccccc" style="background-color: rgb(255, 255, 255);"><span style="font-size: 11.0667px;">// aosp_android-12.1.0_r2\frameworks\native\services\surfaceflinger\Scheduler\Scheduler.cpp</span><span style="font-size: 8.3pt;"><br /></span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">impl</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">EventThread</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(55, 31, 128); font-family: Consolas, monospace; font-size: 8.3pt;">ThrottleVsyncCallback </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">Scheduler</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 98, 122); font-family: Consolas, monospace; font-size: 8.3pt;">makeThrottleVsyncCallback</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">() </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">const </span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">{<br />    std::scoped_lock lock(</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">mRefreshRateConfigsLock</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">);<br />    </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">if </span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">(!</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">mRefreshRateConfigs</span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">-&gt;</span><span style="color: rgb(8, 8, 8); font-family: Consolas, monospace; font-size: 8.3pt; background-color: rgb(204, 204, 204);">supportsFrameRateOverride</span><span style="background-color: rgb(255, 255, 255);"><span style="color: rgb(8, 8, 8); font-family: Consolas, monospace; font-size: 8.3pt;">()) {<br /></span><span style="font-size: 11.0667px;"><font face="consolas" style="" color="#ff0000"><i style="">        // .enableFrameRateOverride 为 false，此处直接返回 {}，即 throttleVsync = {}<br /></i></font></span><span style="color: rgb(8, 8, 8); font-family: Consolas, monospace; font-size: 8.3pt;">        </span></span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">return </span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">{};<br />    }<br /><br />    </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">return </span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">[</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">this</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">](</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(55, 31, 128); font-family: Consolas, monospace; font-size: 8.3pt;">nsecs_t </span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">expectedVsyncTimestamp, </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(55, 31, 128); font-family: Consolas, monospace; font-size: 8.3pt;">uid_t </span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">uid) {<br />        </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">return </span><font color="#080808" face="Consolas, monospace" style=""><span style="font-size: 8.3pt;"><span style="background-color: rgb(255, 255, 255);">!</span><span style="background-color: rgb(204, 204, 204);">isVsyncValid</span><span style="background-color: rgb(255, 255, 255);">(expectedVsyncTimestamp, uid);<br />    };<br />}</span></span></font></pre></pre></pre></div></div></pre></pre></pre></pre></div></div></div></foreignObject><text x="2275" y="1532" fill="rgb(0, 0, 0)" font-family="Courier New" font-size="12px">// aosp_android-12.1.0_r2\frameworks\native\services\surfaceflinger\Scheduler\Scheduler.cppimpl::EventT...</text></switch></g><path d="M 1890 1885 Q 1920 1885 2080 1702.5 Q 2240 1520 2263.63 1520" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2268.88 1520 L 2261.88 1523.5 L 2263.63 1520 L 2261.88 1516.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><ellipse cx="1885" cy="1885" rx="5" ry="5" fill="#000000" stroke="none" pointer-events="all"/><rect x="2950" y="1520" width="670" height="60" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 667px; height: 1px; padding-top: 1520px; margin-left: 2955px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: &quot;Courier New&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><pre style=""><pre style=""><pre style=""><pre style=""><div style="line-height: 16px;"><div style=""><pre style=""><pre style=""><pre style="background-color: rgb(255, 255, 255);"><pre style=""><font face="Consolas, monospace" color="#cccccc"><span style="font-size: 11.0667px;">// aosp_android-12.1.0_r2\frameworks\native\services\surfaceflinger\Scheduler\RefreshRateConfigs.h</span><span style="font-size: 8.3pt;"><br /></span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">bool </span><span style="color: rgb(0, 98, 122); font-family: Consolas, monospace; font-size: 8.3pt;">supportsFrameRateOverride</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">() </span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">const </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">{ </span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">return </span><span style="color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">mSupportsFrameRateOverride</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">; }</span></font></pre></pre></pre></pre></div></div></pre></pre></pre></pre></div></div></div></foreignObject><text x="2955" y="1532" fill="rgb(0, 0, 0)" font-family="Courier New" font-size="12px">// aosp_android-12.1.0_r2\frameworks\native\services\surfaceflinger\Scheduler\RefreshRateConfigs.hbool supports...</text></switch></g><path d="M 2630 1585 Q 2660 1585 2790 1552.5 Q 2920 1520 2943.63 1520" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2948.88 1520 L 2941.88 1523.5 L 2943.63 1520 L 2941.88 1516.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><ellipse cx="2625" cy="1585" rx="5" ry="5" fill="#000000" stroke="none" pointer-events="all"/><rect x="2950" y="1600" width="620" height="190" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 617px; height: 1px; padding-top: 1600px; margin-left: 2955px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: &quot;Courier New&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><pre style=""><pre style=""><pre style=""><pre style=""><div style="line-height: 16px;"><div style=""><pre style=""><pre style=""><pre style=""><pre style=""><pre style=""><font face="Consolas, monospace" color="#cccccc" style="background-color: rgb(255, 255, 255);"><span style="font-size: 11.0667px;">// aosp_android-12.1.0_r2\frameworks\native\services\surfaceflinger\Scheduler\Scheduler.cpp</span><span style="font-size: 8.3pt;"><br /></span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">bool </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">Scheduler</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 98, 122); font-family: Consolas, monospace; font-size: 8.3pt;">isVsyncValid</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">(</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(55, 31, 128); font-family: Consolas, monospace; font-size: 8.3pt;">nsecs_t </span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">expectedVsyncTimestamp, </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(55, 31, 128); font-family: Consolas, monospace; font-size: 8.3pt;">uid_t </span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">uid) </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">const </span><span style="background-color: rgb(255, 255, 255); color: rgb(8, 8, 8); font-family: Consolas, monospace; font-size: 8.3pt;">{<br /></span><span style="background-color: rgb(255, 255, 255); font-size: 11.0667px;"><font face="consolas" style="" color="#ff0000"><i style="">    // 获取 uid 对应的帧率重载对象<br /></i></font></span><span style="background-color: rgb(255, 255, 255); color: rgb(8, 8, 8); font-family: Consolas, monospace; font-size: 8.3pt;">    </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">const auto </span><span style="background-color: rgb(255, 255, 255); color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">frameRate </span><font color="#080808" face="Consolas, monospace" style=""><span style="font-size: 8.3pt;"><span style="background-color: rgb(255, 255, 255);">= </span><span style="background-color: rgb(204, 204, 204);">getFrameRateOverride</span><span style="background-color: rgb(255, 255, 255);">(uid);<br />    </span></span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">if </span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">(!frameRate.has_value()) {<br />        </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">return true</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">;<br />    }<br /><br />    </span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">return </span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">mVsyncSchedule.tracker-&gt;isVSyncInPhase(expectedVsyncTimestamp, *frameRate);<br />}</span></font></pre></pre></pre></pre></pre></div></div></pre></pre></pre></pre></div></div></div></foreignObject><text x="2955" y="1612" fill="rgb(0, 0, 0)" font-family="Courier New" font-size="12px">// aosp_android-12.1.0_r2\frameworks\native\services\surfaceflinger\Scheduler\Scheduler.cppbool Schedul...</text></switch></g><path d="M 2450 1685 Q 2480 1685 2700 1642.5 Q 2920 1600 2943.63 1600" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 2948.88 1600 L 2941.88 1603.5 L 2943.63 1600 L 2941.88 1596.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><ellipse cx="2445" cy="1685" rx="5" ry="5" fill="#000000" stroke="none" pointer-events="all"/><rect x="3630" y="1600" width="620" height="510" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 617px; height: 1px; padding-top: 1600px; margin-left: 3635px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: &quot;Courier New&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><pre style=""><pre style=""><pre style=""><pre style=""><div style="line-height: 16px;"><div style=""><pre style=""><pre style=""><pre style="background-color: rgb(255, 255, 255);"><pre style=""><pre style=""><pre style=""><font face="Consolas, monospace"><span style="font-size: 11.0667px;"><font color="#cccccc">// aosp_android-12.1.0_r2\frameworks\native\services\surfaceflinger\Scheduler\Scheduler.cpp</font></span><span style="font-size: 8.3pt;"><font color="#cccccc"><br /></font><font color="#080808">std::optional&lt;Fps&gt; </font></span></font><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">Scheduler</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">::</span></font><span style="color: rgb(0, 98, 122); font-family: Consolas, monospace; font-size: 8.3pt;">getFrameRateOverride</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">(uid_t uid) </span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">const </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">{<br /></span><span style="font-size: 8.3pt;">    {<br />        std::scoped_lock lock(</span></font><span style="color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">mRefreshRateConfigsLock</span><span style="color: rgb(8, 8, 8); font-family: Consolas, monospace; font-size: 8.3pt;">);<br /></span><span style="font-size: 11.0667px;"><font face="consolas" style="" color="#ff0000"><i style="">        // RefreshRateConfigs::mSupportsFrameRateOverride = false<br /></i></font></span><span style="color: rgb(8, 8, 8); font-family: Consolas, monospace; font-size: 8.3pt;">        </span><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">if </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">(!</span></font><span style="color: rgb(102, 14, 122); font-family: Consolas, monospace; font-size: 8.3pt;">mRefreshRateConfigs</span><span style="color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">-&gt;</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">supportsFrameRateOverride()) {<br />            </span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">return </span><span style="color: rgb(8, 8, 8); font-family: Consolas, monospace; font-size: 8.3pt;">std::nullopt;<br />        }<br />    }<br /></span><span style="font-size: 11.0667px;"><font face="consolas" style="" color="#ff0000"><i style="">    // 对每个 uid 有两处配置重载的地方：<br />    //     mFrameRateOverridesFromBackdoor<br />    //     mFrameRateOverridesByContent<br />    // 优先级递减<br /></i></font></span><span style="color: rgb(8, 8, 8); font-family: Consolas, monospace; font-size: 8.3pt;">    std::lock_guard </span><span style="color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">lock</span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">(mFrameRateOverridesLock);<br />    {<br />        </span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">const auto </span><span style="color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">iter </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">= mFrameRateOverridesFromBackdoor.find(uid);<br />        </span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">if </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">(iter != mFrameRateOverridesFromBackdoor.end()) {<br />            </span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">return </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">std::make_optional&lt;Fps&gt;(iter-&gt;second);<br />        }<br />    }<br /><br />    {<br />        </span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">const auto </span><span style="color: rgb(0, 0, 0); font-family: Consolas, monospace; font-size: 8.3pt;">iter </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">= mFrameRateOverridesByContent.find(uid);<br />        </span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">if </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">(iter != mFrameRateOverridesByContent.end()) {<br />            </span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">return </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">std::make_optional&lt;Fps&gt;(iter-&gt;second);<br />        }<br />    }<br /><br />    </span></font><span style="color: rgb(0, 51, 179); font-family: Consolas, monospace; font-size: 8.3pt;">return </span><font color="#080808" face="Consolas, monospace"><span style="font-size: 8.3pt;">std::nullopt;<br />}</span></font></pre></pre></pre></pre></pre></pre></div></div></pre></pre></pre></pre></div></div></div></foreignObject><text x="3635" y="1612" fill="rgb(0, 0, 0)" font-family="Courier New" font-size="12px">// aosp_android-12.1.0_r2\frameworks\native\services\surfaceflinger\Scheduler\Scheduler.cppstd::optiona...</text></switch></g><path d="M 3250 1665 Q 3280 1665 3440 1632.5 Q 3600 1600 3623.63 1600" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 3628.88 1600 L 3621.88 1603.5 L 3623.63 1600 L 3621.88 1596.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><ellipse cx="3245" cy="1665" rx="5" ry="5" fill="#000000" stroke="none" pointer-events="all"/><rect x="5070" y="2429" width="290" height="90" fill="rgb(255, 255, 255)" stroke="#000000" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 287px; height: 1px; padding-top: 2429px; margin-left: 5075px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: &quot;Courier New&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><pre style=""><pre style=""><pre style=""><pre style=""><pre style=""><pre style=""><pre style=""><div style="line-height: 16px;"><div style="line-height: 16px;"><div style="line-height: 16px;"><div style="line-height: 16px;"><div style="line-height: 16px;"><div style="line-height: 16px;"><div style=""><pre style=""><font face="Consolas, monospace" color="#cccccc" style="background-color: rgb(255, 255, 255);"><span style="font-size: 11.0667px;">// frameworks\native\libs\gui\BitTube.cpp<br /></span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 128, 128); font-family: Consolas, monospace; font-size: 8.3pt;">BitTube</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">::</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(0, 98, 122); font-family: Consolas, monospace; font-size: 8.3pt;">BitTube</span><font color="#080808" face="Consolas, monospace" style="background-color: rgb(255, 255, 255);"><span style="font-size: 8.3pt;">(</span></font><span style="background-color: rgb(255, 255, 255); color: rgb(55, 31, 128); font-family: Consolas, monospace; font-size: 8.3pt;">size_t </span><font color="#080808" face="Consolas, monospace" style=""><span style="font-size: 8.3pt;"><span style="background-color: rgb(255, 255, 255);">bufsize) {<br />    </span><span style="background-color: rgb(204, 204, 204);">init</span><span style="background-color: rgb(255, 255, 255);">(bufsize, bufsize);<br />}</span></span></font></pre></div></div></div></div></div></div></div></pre></pre></pre></pre></pre></pre></pre></div></div></div></foreignObject><text x="5075" y="2441" fill="rgb(0, 0, 0)" font-family="Courier New" font-size="12px">// frameworks\native\libs\gui\BitTube.cpp...</text></switch></g><rect x="0" y="620" width="30" height="20" rx="10" ry="10" fill="#ff0000" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 630px; margin-left: 1px;"><div data-drawio-colors="color: #FFFFFF; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">1</div></div></div></foreignObject><text x="15" y="634" fill="#FFFFFF" font-family="Helvetica" font-size="12px" text-anchor="middle">1</text></switch></g><rect x="870" y="1040" width="30" height="20" rx="10" ry="10" fill="#ff0000" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 1050px; margin-left: 871px;"><div data-drawio-colors="color: #FFFFFF; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">2</div></div></div></foreignObject><text x="885" y="1054" fill="#FFFFFF" font-family="Helvetica" font-size="12px" text-anchor="middle">2</text></switch></g><rect x="70" y="1810" width="30" height="20" rx="10" ry="10" fill="#ff0000" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 1820px; margin-left: 71px;"><div data-drawio-colors="color: #FFFFFF; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">3</div></div></div></foreignObject><text x="85" y="1824" fill="#FFFFFF" font-family="Helvetica" font-size="12px" text-anchor="middle">3</text></switch></g><rect x="790" y="2120" width="30" height="20" rx="10" ry="10" fill="#ff0000" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 2130px; margin-left: 791px;"><div data-drawio-colors="color: #FFFFFF; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">4</div></div></div></foreignObject><text x="805" y="2134" fill="#FFFFFF" font-family="Helvetica" font-size="12px" text-anchor="middle">4</text></switch></g><rect x="1550" y="1875" width="30" height="20" rx="10" ry="10" fill="#ff0000" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 1885px; margin-left: 1551px;"><div data-drawio-colors="color: #FFFFFF; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">5</div></div></div></foreignObject><text x="1565" y="1889" fill="#FFFFFF" font-family="Helvetica" font-size="12px" text-anchor="middle">5</text></switch></g><rect x="1550" y="1905" width="30" height="20" rx="10" ry="10" fill="#ff0000" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 1915px; margin-left: 1551px;"><div data-drawio-colors="color: #FFFFFF; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">6</div></div></div></foreignObject><text x="1565" y="1919" fill="#FFFFFF" font-family="Helvetica" font-size="12px" text-anchor="middle">6</text></switch></g><rect x="2270" y="2620" width="30" height="20" rx="10" ry="10" fill="#ff0000" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 28px; height: 1px; padding-top: 2630px; margin-left: 2271px;"><div data-drawio-colors="color: #FFFFFF; " style="box-sizing: border-box; font-size: 0px; text-align: center;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">7</div></div></div></foreignObject><text x="2285" y="2634" fill="#FFFFFF" font-family="Helvetica" font-size="12px" text-anchor="middle">7</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>