<?xml version="1.0" encoding="UTF-8"?>
<!-- Do not edit this file with editors other than diagrams.net -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="801px" height="1231px" viewBox="-0.5 -0.5 801 1231" content="&lt;mxfile host=&quot;app.diagrams.net&quot; modified=&quot;2022-02-14T17:24:21.092Z&quot; agent=&quot;5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.164 Safari/537.36&quot; version=&quot;16.5.6&quot; etag=&quot;EmCRy7LOJwu08Xu6I8__&quot; type=&quot;device&quot;&gt;&lt;diagram id=&quot;QfZU9jF017hJnhrdDiPH&quot; name=&quot;Page-1&quot;&gt;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&lt;/diagram&gt;&lt;/mxfile&gt;"><defs/><g><rect x="90" y="30" width="710" height="1200" fill="#f5f5f5" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 708px; height: 1px; padding-top: 37px; margin-left: 92px;"><div data-drawio-colors="color: #999999; " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(153, 153, 153); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">system_server(892)</div></div></div></foreignObject><text x="92" y="49" fill="#999999" font-family="Helvetica" font-size="12px" font-weight="bold">system_server(892)</text></switch></g><path d="M 190 270 L 190 953.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 190 958.88 L 186.5 951.88 L 190 953.63 L 193.5 951.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="190" y="80" width="430" height="190" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 428px; height: 1px; padding-top: 78px; margin-left: 192px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: &quot;Courier New&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><pre style="font-size: 8.3pt ; font-family: &quot;consolas&quot; , monospace"><pre style="font-family: &quot;consolas&quot; , monospace ; font-size: 8.3pt"><pre style="font-size: 8.3pt ; background-color: rgb(255 , 255 , 255) ; font-family: &quot;consolas&quot; , monospace"><pre style="font-family: &quot;consolas&quot; , monospace ; font-size: 8.3pt"><span style="color: rgb(0 , 0 , 128) ; font-weight: bold">class </span>ServerThread <span style="color: rgb(0 , 0 , 128) ; font-weight: bold">extends </span>Thread {<br />    <font color="#000080"><b>...</b></font><br />    <span style="color: rgb(128 , 128 , 0)">@Override<br /></span><span style="color: rgb(128 , 128 , 0)">    </span><span style="color: rgb(0 , 0 , 128) ; font-weight: bold">public void </span>run() {<br />        ...<br />        <span style="color: rgb(128 , 128 , 128) ; font-style: italic">// Critical services...<br /></span><span style="color: rgb(128 , 128 , 128) ; font-style: italic">        </span><span style="color: rgb(0 , 0 , 128) ; font-weight: bold">try </span>{<br />            ...<br />            Slog.<span style="color: rgb(0 , 0 , 0) ; font-style: italic">i</span>(<span style="color: rgb(102 , 14 , 122) ; font-weight: bold ; font-style: italic">TAG</span>, <span style="color: rgb(0 , 128 , 0) ; font-weight: bold">"Activity Manager"</span>);</pre><pre style="font-family: &quot;consolas&quot; , monospace ; font-size: 8.3pt"><br /></pre><pre style="font-family: &quot;consolas&quot; , monospace ; font-size: 8.3pt">            context = ActivityManagerService.<span style="color: rgb(0 , 0 , 0) ; font-style: italic">main</span>(factoryTest);</pre></pre></pre></pre></div></div></div></foreignObject><text x="192" y="90" fill="rgb(0, 0, 0)" font-family="Courier New" font-size="12px">class ServerThread extends Thread {...</text></switch></g><rect x="190" y="60" width="100" height="20" rx="10" ry="10" fill="#999999" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 91px; height: 1px; padding-top: 70px; margin-left: 199px;"><div data-drawio-colors="color: #FFFFFF; " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">SystemServer</div></div></div></foreignObject><text x="199" y="74" fill="#FFFFFF" font-family="Helvetica" font-size="12px" font-weight="bold">SystemServer</text></switch></g><rect x="300" y="60" width="480" height="20" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 1px; height: 1px; padding-top: 70px; margin-left: 302px;"><div data-drawio-colors="color: #999999; " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(153, 153, 153); line-height: 1.2; pointer-events: all; white-space: nowrap;">android-4.0.1_r1\frameworks\base\services\java\com\android\server\SystemServer.java</div></div></div></foreignObject><text x="302" y="74" fill="#999999" font-family="Helvetica" font-size="12px">android-4.0.1_r1\frameworks\base\services\java\com\android\server\SystemServer.j...</text></switch></g><rect x="0" y="80" width="190" height="20" fill="#000000" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-end; width: 178px; height: 1px; padding-top: 90px; margin-left: 0px;"><div data-drawio-colors="color: #ffffff; " style="box-sizing: border-box; font-size: 0px; text-align: right;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">"android.server.ServerThread"</div></div></div></foreignObject><text x="178" y="94" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="end">"android.server.ServerThread"</text></switch></g><path d="M 90 20 L 90 10 L 90 0 L 170.23 0 L 180 10 L 170.23 20 Z" fill="#f5f5f5" stroke="#666666" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-end; width: 1px; height: 1px; padding-top: 10px; margin-left: 163px;"><div data-drawio-colors="color: #333333; " style="box-sizing: border-box; font-size: 0px; text-align: right;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(51, 51, 51); line-height: 1.2; pointer-events: all; white-space: nowrap;"><span style="font-size: 12px">AMS初始化</span></div></div></div></foreignObject><text x="163" y="14" fill="#333333" font-family="Helvetica" font-size="14px" text-anchor="end">AMS初始化</text></switch></g><rect x="90" y="220" width="710" height="19.15" fill="#e6e6e6" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 708px; height: 1px; padding-top: 230px; margin-left: 92px;"><div data-drawio-colors="color: #333333; " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: &quot;Lucida Console&quot;; color: rgb(51, 51, 51); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><div>02-14 16:36:37.170   892   906 I SystemServer: Activity Manager</div></div></div></div></foreignObject><text x="92" y="233" fill="#333333" font-family="Lucida Console" font-size="12px">02-14 16:36:37.170   892   906 I SystemServer: Activity Manager</text></switch></g><path d="M 210 560 L 210 570 L 210 573.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 210 578.88 L 206.5 571.88 L 210 573.63 L 213.5 571.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="210" y="290" width="380" height="270" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 378px; height: 1px; padding-top: 288px; margin-left: 212px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: &quot;Courier New&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><pre style="font-size: 8.3pt ; font-family: &quot;consolas&quot; , monospace"><pre style="font-family: &quot;consolas&quot; , monospace ; font-size: 8.3pt"><pre style="font-size: 8.3pt ; background-color: rgb(255 , 255 , 255) ; font-family: &quot;consolas&quot; , monospace"><pre style="font-family: &quot;consolas&quot; , monospace ; font-size: 8.3pt"><pre style="font-family: &quot;consolas&quot; , monospace ; font-size: 8.3pt"><span style="color: #000080 ; font-weight: bold">public static final </span>Context main(<span style="color: #000080 ; font-weight: bold">int </span>factoryTest) {<br />    AThread thr = <span style="color: #000080 ; font-weight: bold">new </span>AThread();<br />    thr.start();<br /><br />    <span style="color: #000080 ; font-weight: bold">synchronized </span>(thr) {<br />        <span style="color: #000080 ; font-weight: bold">while </span>(thr.<span style="color: #660e7a ; font-weight: bold">mService </span>== <span style="color: #000080 ; font-weight: bold">null</span>) {<br />            <span style="color: #000080 ; font-weight: bold">try </span>{<br />                thr.wait();<br />            } <span style="color: #000080 ; font-weight: bold">catch </span>(InterruptedException e) {<br />            }<br />        }<br />    }<br /><br />    ...<br />    m.<span style="color: #660e7a ; font-weight: bold">mMainStack </span>= <span style="color: #000080 ; font-weight: bold">new </span>ActivityStack(m, context, <span style="color: #000080 ; font-weight: bold">true</span>);<br />    ...<br />    <span style="color: #000080 ; font-weight: bold">return </span>context;<br />}</pre></pre></pre></pre></pre></div></div></div></foreignObject><text x="212" y="300" fill="rgb(0, 0, 0)" font-family="Courier New" font-size="12px">public static final Context main(int factoryTest) {...</text></switch></g><path d="M 30 414 L 30 404 L 30 394 L 200.23 394 L 210 404 L 200.23 414 Z" fill="#fff2cc" stroke="#d6b656" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-end; width: 1px; height: 1px; padding-top: 404px; margin-left: 193px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: right;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;"><span style="font-size: 12px">同步等待AThread初始化完成<br /></span></div></div></div></foreignObject><text x="193" y="408" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="end">同步等待AThread初始化完成&#xa;</text></switch></g><rect x="230" y="580" width="460" height="370" fill="rgb(255, 255, 255)" stroke="#97d077" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 458px; height: 1px; padding-top: 578px; margin-left: 232px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: &quot;Courier New&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><pre style="font-size: 8.3pt ; font-family: &quot;consolas&quot; , monospace"><pre style="font-family: &quot;consolas&quot; , monospace ; font-size: 8.3pt"><pre style="font-size: 8.3pt ; background-color: rgb(255 , 255 , 255) ; font-family: &quot;consolas&quot; , monospace"><pre style="font-family: &quot;consolas&quot; , monospace ; font-size: 8.3pt"><pre style="font-family: &quot;consolas&quot; , monospace ; font-size: 8.3pt"><pre style="font-family: &quot;consolas&quot; , monospace ; font-size: 8.3pt"><span style="color: #0000ff">    </span><span style="color: #000080 ; font-weight: bold">static class </span>AThread <span style="color: #000080 ; font-weight: bold">extends </span>Thread {<br />        ActivityManagerService <span style="color: #660e7a ; font-weight: bold">mService</span>;<br />        <span style="color: #000080 ; font-weight: bold">boolean </span><span style="color: #660e7a ; font-weight: bold">mReady </span>= <span style="color: #000080 ; font-weight: bold">false</span>;<br /><br />        <span style="color: #000080 ; font-weight: bold">public </span>AThread() {<br />            <span style="color: #000080 ; font-weight: bold">super</span>(<span style="color: #008000 ; font-weight: bold">"ActivityManager"</span>);<br />        }<br /><br />        <span style="color: #000080 ; font-weight: bold">public void </span>run() {<br />            Looper.<span style="font-style: italic">prepare</span>();<br /><br />            android.os.Process.<span style="font-style: italic">setThreadPriority</span>(<br />                    android.os.Process.<span style="color: #660e7a ; font-weight: bold ; font-style: italic">THREAD_PRIORITY_FOREGROUND</span>);<br />            android.os.Process.<span style="font-style: italic">setCanSelfBackground</span>(<span style="color: #000080 ; font-weight: bold">false</span>);<br /><br />            ActivityManagerService m = <span style="color: #000080 ; font-weight: bold">new </span>ActivityManagerService();<br /><br />            <span style="color: #000080 ; font-weight: bold">synchronized </span>(<span style="color: #000080 ; font-weight: bold">this</span>) {<br />                <span style="color: #660e7a ; font-weight: bold">mService </span>= m;<br />                notifyAll();<br />            }<br />            <font color="#000080"><b>...</b></font><br />            Looper.<span style="font-style: italic">loop</span>();<br />        }<br />    }<br /></pre></pre></pre></pre></pre></pre></div></div></div></foreignObject><text x="232" y="590" fill="rgb(0, 0, 0)" font-family="Courier New" font-size="12px">static class AThread extends Thread {...</text></switch></g><rect x="110" y="580" width="120" height="20" fill="#97d077" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-end; width: 108px; height: 1px; padding-top: 590px; margin-left: 110px;"><div data-drawio-colors="color: #ffffff; " style="box-sizing: border-box; font-size: 0px; text-align: right;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">"ActivityManager"</div></div></div></foreignObject><text x="218" y="594" fill="#ffffff" font-family="Helvetica" font-size="12px" text-anchor="end">"ActivityManager"</text></switch></g><path d="M 60 870 L 60 860 L 60 850 L 220.23 850 L 230 860 L 220.23 870 Z" fill="#fff2cc" stroke="#d6b656" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-end; width: 1px; height: 1px; padding-top: 860px; margin-left: 213px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: right;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;"><span style="font-size: 12px">初始化完成后唤醒等待线程<br /></span></div></div></div></foreignObject><text x="213" y="864" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="end">初始化完成后唤醒等待线程&#xa;</text></switch></g><rect x="210" y="270" width="160" height="20" rx="10" ry="10" fill="#999999" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 151px; height: 1px; padding-top: 280px; margin-left: 219px;"><div data-drawio-colors="color: #FFFFFF; " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">ActivityManagerService</div></div></div></foreignObject><text x="219" y="284" fill="#FFFFFF" font-family="Helvetica" font-size="12px" font-weight="bold">ActivityManagerService</text></switch></g><rect x="190" y="960" width="370" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 368px; height: 1px; padding-top: 958px; margin-left: 192px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: &quot;Courier New&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><pre style="font-size: 8.3pt ; font-family: &quot;consolas&quot; , monospace"><pre style="font-family: &quot;consolas&quot; , monospace ; font-size: 8.3pt"><pre style="font-size: 8.3pt ; background-color: rgb(255 , 255 , 255) ; font-family: &quot;consolas&quot; , monospace"><pre style="font-family: &quot;consolas&quot; , monospace ; font-size: 8.3pt"><pre style="font-family: &quot;consolas&quot; , monospace ; font-size: 8.3pt"><span style="color: #0000ff">            </span>ActivityManagerService.<span style="font-style: italic">setSystemProcess</span>();<br /></pre></pre></pre></pre></pre></div></div></div></foreignObject><text x="192" y="970" fill="rgb(0, 0, 0)" font-family="Courier New" font-size="12px">            ActivityManagerService.setSystemProcess();&#xa;</text></switch></g><rect x="210" y="1010" width="550" height="210" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe flex-start; justify-content: unsafe flex-start; width: 548px; height: 1px; padding-top: 1008px; margin-left: 212px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: &quot;Courier New&quot;; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><pre style="font-size: 8.3pt ; font-family: &quot;consolas&quot; , monospace"><pre style="font-family: &quot;consolas&quot; , monospace ; font-size: 8.3pt"><pre style="font-size: 8.3pt ; background-color: rgb(255 , 255 , 255) ; font-family: &quot;consolas&quot; , monospace"><pre style="font-family: &quot;consolas&quot; , monospace ; font-size: 8.3pt"><pre style="font-family: &quot;consolas&quot; , monospace ; font-size: 8.3pt"><pre style="font-family: &quot;consolas&quot; , monospace ; font-size: 8.3pt"><span style="color: #0000ff">    </span><span style="color: #000080 ; font-weight: bold">public static void </span>setSystemProcess() {<br />        <span style="color: #000080 ; font-weight: bold">try </span>{<br />            ActivityManagerService m = <span style="color: #660e7a ; font-style: italic">mSelf</span>;<br />            <br />            ServiceManager.<span style="font-style: italic">addService</span>(<span style="color: #008000 ; font-weight: bold">"activity"</span>, m);<br />            ServiceManager.<span style="font-style: italic">addService</span>(<span style="color: #008000 ; font-weight: bold">"meminfo"</span>, <span style="color: #000080 ; font-weight: bold">new </span>MemBinder(m));<br />            ServiceManager.<span style="font-style: italic">addService</span>(<span style="color: #008000 ; font-weight: bold">"gfxinfo"</span>, <span style="color: #000080 ; font-weight: bold">new </span>GraphicsBinder(m));<br />            <span style="color: #000080 ; font-weight: bold">if </span>(<span style="color: #660e7a ; font-weight: bold ; font-style: italic">MONITOR_CPU_USAGE</span>) {<br />                ServiceManager.<span style="font-style: italic">addService</span>(<span style="color: #008000 ; font-weight: bold">"cpuinfo"</span>, <span style="color: #000080 ; font-weight: bold">new </span>CpuBinder(m));<br />            }<br />            ServiceManager.<span style="font-style: italic">addService</span>(<span style="color: #008000 ; font-weight: bold">"permission"</span>, <span style="color: #000080 ; font-weight: bold">new </span>PermissionController(m));<br />            <font color="#000080"><b>...</b></font><br />        }<br />    }<br /></pre></pre></pre></pre></pre></pre></div></div></div></foreignObject><text x="212" y="1020" fill="rgb(0, 0, 0)" font-family="Courier New" font-size="12px">public static void setSystemProcess() {...</text></switch></g><rect x="210" y="990" width="160" height="20" rx="10" ry="10" fill="#999999" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-start; width: 151px; height: 1px; padding-top: 1000px; margin-left: 219px;"><div data-drawio-colors="color: #FFFFFF; " style="box-sizing: border-box; font-size: 0px; text-align: left;"><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(255, 255, 255); line-height: 1.2; pointer-events: all; font-weight: bold; white-space: normal; overflow-wrap: normal;">ActivityManagerService</div></div></div></foreignObject><text x="219" y="1004" fill="#FFFFFF" font-family="Helvetica" font-size="12px" font-weight="bold">ActivityManagerService</text></switch></g><path d="M 0 1090 L 0 1080 L 0 1070 L 200.23 1070 L 210 1080 L 200.23 1090 Z" fill="#fff2cc" stroke="#d6b656" stroke-miterlimit="10" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility" style="overflow: visible; text-align: left;"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe flex-end; width: 1px; height: 1px; padding-top: 1080px; margin-left: 193px;"><div data-drawio-colors="color: rgb(0, 0, 0); " style="box-sizing: border-box; font-size: 0px; text-align: right;"><div style="display: inline-block; font-size: 14px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: nowrap;">将“activity”注册为binder服务</div></div></div></foreignObject><text x="193" y="1084" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="14px" text-anchor="end">将“activity”注册为binder服务</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>